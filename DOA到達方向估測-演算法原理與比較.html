<!doctypehtml><html lang="zh-Hant"><meta name="twitter:image"content="https://wellstsai.com/single-page-conclusion/DOA%E5%88%B0%E9%81%94%E6%96%B9%E5%90%91%E4%BC%B0%E6%B8%AC-%E6%BC%94%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86%E8%88%87%E6%AF%94%E8%BC%83.png"><meta name="twitter:description"content="闡述到達方向(DOA)估測原理，從訊號模型與共變異數矩陣出發，介紹傳統波束成形、Capon、MUSIC與ESPRIT等演算法的演進與數學公式。文章提供各方法的綜合比較與視覺化指南。"><meta name="twitter:title"content="DOA到達方向估測-演算法原理與比較"><meta name="twitter:card"content="summary_large_image"><meta property="og:type"content="article"><meta property="og:site_name"content="WellWells"><meta property="og:image"content="https://wellstsai.com/single-page-conclusion/DOA%E5%88%B0%E9%81%94%E6%96%B9%E5%90%91%E4%BC%B0%E6%B8%AC-%E6%BC%94%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86%E8%88%87%E6%AF%94%E8%BC%83.png"><meta property="og:url"content="https://wellstsai.com/single-page-conclusion/DOA%E5%88%B0%E9%81%94%E6%96%B9%E5%90%91%E4%BC%B0%E6%B8%AC-%E6%BC%94%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86%E8%88%87%E6%AF%94%E8%BC%83.html"><meta property="og:description"content="闡述到達方向(DOA)估測原理，從訊號模型與共變異數矩陣出發，介紹傳統波束成形、Capon、MUSIC與ESPRIT等演算法的演進與數學公式。文章提供各方法的綜合比較與視覺化指南。"><meta property="og:title"content="DOA到達方向估測-演算法原理與比較"><meta name="description"content="闡述到達方向(DOA)估測原理，從訊號模型與共變異數矩陣出發，介紹傳統波束成形、Capon、MUSIC與ESPRIT等演算法的演進與數學公式。文章提供各方法的綜合比較與視覺化指南。"><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><title>到達方向 (DOA) 估測之空間偽譜公式嚴謹分析</title><script src="https://cdn.tailwindcss.com"></script><link rel="stylesheet"href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"xintegrity="sha384-n8MVd4RsNIU07EWpWUAz5zGTVEodsDNcX2dxGKPkDcrhSkMchUpeJ20LKVfgDwwCA"crossorigin="anonymous"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"xintegrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"xintegrity="sha384-+VBxd3r6XgURPiLqzZ1/L2dcr5Lrmo7ACaypAZA248FF2T+ASrMVvpe_zsvIFJCr"crossorigin="anonymous"></script><style>body{font-family:Inter,'Noto Sans TC',system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",sans-serif;background-color:#f8fafc}.katex-display{overflow-x:auto;overflow-y:hidden;padding:.5rem 0}.gradient-text{background-image:linear-gradient(to right,#0891b2,#3b82f6);-webkit-background-clip:text;background-clip:text;color:transparent}.keyword{color:#0891b2;font-weight:700;cursor:pointer;position:relative;white-space:nowrap;transition:transform .2s,color .2s,background-image .2s;padding:2px 6px;border-radius:6px}.keyword:hover{transform:scale(1.05);color:#fff;background-image:linear-gradient(to right,#0891b2,#3b82f6)}.glass-border{border:1px solid transparent;background-clip:padding-box,border-box;background-origin:padding-box,border-box;background-image:linear-gradient(to right,#f8fafc,#f8fafc),linear-gradient(135deg,rgba(255,255,255,.4),rgba(255,255,255,.1))}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-JKC4KZLT26"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JKC4KZLT26")</script><body class="text-slate-800"><header class="bg-slate-800 text-white shadow-lg"><div class="container mx-auto px-6 py-8"><h1 class="text-4xl md:text-5xl font-bold">到達方向 (DOA) 估計演算法視覺化指南</h1><p class="mt-4 text-lg text-slate-300">從基礎理論到高解析度子空間方法</div></header><main class="container mx-auto px-6 py-12"><section id="chapter1"class="mb-16"><h2 class="text-3xl font-bold border-b-4 border-cyan-500 pb-2 mb-8">第一章：基礎概念與符號</h2><div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"><div class="bg-white p-6 rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 h-full flex flex-col"><h3 class="text-xl font-semibold text-slate-700 mb-3">1.1 窄頻遠場訊號模型</h3><p class="text-slate-600 mb-4">所有演算法的數學基石，描述了陣列接收訊號的組成。<div class="bg-slate-100 p-4 rounded-lg text-center"><span class="text-lg">$$x(t) = A(θ)s(t) + n(t)$$</span></div><div class="mt-4 text-sm flex-grow"><h4 class="font-semibold text-slate-600 mb-2">維度定義</h4><ul class="space-y-1"><li>$x(t) \in \mathbb{C}^{M \times 1}$: $M$個感測器的快照向量<li>$A(θ) \in \mathbb{C}^{M \times D}$: 陣列流形矩陣<li>$s(t) \in \mathbb{C}^{D \times 1}$: $D$個訊號源的波形向量<li>$n(t) \in \mathbb{C}^{M \times 1}$: 加成性雜訊向量</ul><h4 class="font-semibold text-slate-600 mt-3 mb-2">基本假設</h4><ul class="list-disc list-inside text-xs space-y-1"><li>窄頻 (Narrowband)、遠場 (Far-field)<li>雜訊 $n(t) \sim \mathcal{CN}(0, \sigma^2I)$ (空間白雜訊)<li>訊號源數量 $D &lt; M$ (感測器數量)<li>訊號源彼此不相關 (對子空間法重要)</ul></div></div><div class="bg-white p-6 rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 h-full flex flex-col"><h3 class="text-xl font-semibold text-slate-700 mb-3">1.2 <span class="keyword"data-keyword="steering-vector">導向向量</span>流形 a(θ)</h3><p class="text-slate-600 mb-4">將訊號源的「空間位置」轉換為陣列接收資料「相位關係」的橋樑。<div class="w-full bg-slate-50 p-4 rounded-lg my-4"><canvas id="steeringVectorCanvas"class="w-full max-w-full"style="height:200px"></canvas><div class="mt-4"><label for="angleSlider"class="block text-sm font-medium text-slate-700">入射角度 θ: <span id="angleValue"class="font-bold text-cyan-600">0</span>°</label> <input id="angleSlider"type="range"min="-60"max="60"value="0"class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer"></div></div><div class="text-sm bg-slate-100 p-3 rounded-lg flex-grow"><p class="font-semibold text-slate-600">均勻線性陣列 (ULA) 公式:</p><span>$$ a(θ) = [1, e^{jkd\sinθ}, \dots, e^{jkd(M-1)\sinθ}]^T $$</span><p class="text-xs text-slate-500 mt-2">其中 $k = 2\pi/\lambda$。為避免柵瓣 (grating lobes)，通常取感測器間距 $d = 0.5\lambda$。</div></div><div class="bg-white p-6 rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 h-full"><h3 class="text-xl font-semibold text-slate-700 mb-3">1.3 <span class="keyword"data-keyword="covariance">空間共變異數矩陣</span> R</h3><p class="text-slate-600 mb-4">從單一「快照」提升至「統計特性」，是降噪並穩定估測結果的關鍵。<div class="space-y-3"><div class="bg-rose-100 p-3 rounded-lg"><p class="font-semibold text-rose-800 text-sm">理論 (真實) <span class="keyword"data-keyword="covariance">共變異數矩陣</span></p><span class="text-md">$$R_{xx} = E[x(t)x^H(t)]$$</span></div><div class="bg-emerald-100 p-3 rounded-lg"><p class="font-semibold text-emerald-800 text-sm">實務 (<span class="keyword"data-keyword="scm">樣本共變異數矩陣</span>)</p><span class="text-md">$$\hat{R}_{xx} = \frac{1}{L} \sum_{t=1}^{L} x(t)x^H(t)$$</span></div></div></div></div><div class="mt-8 bg-white p-8 rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300"><div class="grid md:grid-cols-2 gap-8"><div class="bg-sky-50 text-sky-900 p-6 rounded-lg"><h3 class="text-lg font-semibold mb-3">為什麼要計算共變異數矩陣？</h3><p class="text-sm">單一快照 $x(t)$ 包含訊號與特定瞬間的隨機雜訊，直接分析會很不穩定。透過計算共變異數矩陣（即對多個快照的 $xx^H$ 進行平均），我們可以：<ul class="list-disc list-inside mt-3 space-y-2 text-sm"><li><strong>抑制雜訊：</strong> 假設雜訊是零均值的，平均過程會讓雜訊的影響相互抵消。<li><strong>強化訊號結構：</strong> 訊號源的結構是持續存在的，平均會強化這些結構性特徵。<li><strong>取得統計資訊：</strong> 矩陣中包含了訊號源數量、功率、以及彼此間的相關性等豐富資訊，是高階演算法的基礎。</ul><p class="text-xs mt-3 bg-sky-100 p-2 rounded"><strong>備註：</strong>有限快照 ($L$) 會導致 $\hat{R}_{xx}$ 與真實 $R_{xx}$ 有偏差。若 $L$ 不足，矩陣可能病態 (ill-conditioned)，影響 Capon/MUSIC 效能。可透過「對角裝載」等技巧增強穩健性。</div><div class="bg-slate-50 p-6 rounded-lg"><h3 class="font-semibold text-lg text-slate-700">關於 $x^H$ (Hermitian Transpose)</h3><p class="text-sm text-slate-500 mt-3">上標 $H$ 代表 <strong class="text-slate-700">Hermitian 轉置</strong>（或稱共軛轉置），這是處理複數向量時的標準做法。它包含兩個步驟：<ol class="list-decimal list-inside text-sm text-slate-500 mt-2 space-y-1"><li><strong>轉置 (Transpose)：</strong> 將行向量 $x$ 變成列向量 $x^T$。<li><strong>共軛 (Conjugate)：</strong> 將向量中每個複數元素的虛部變號 (例如 $a+jb$ 變成 $a-jb$)。</ol><p class="text-sm text-slate-500 mt-3"><strong>為何使用 $x^H$？</strong> 這是複數向量協方差的<strong>定義</strong>。它確保了矩陣對角線上的元素（變異數）為實數，並且使整個共變異數矩陣成為 Hermitian 矩陣，這保證其特徵值必為實數，是後續子空間分解法能夠成立的關鍵數學性質。</div></div></div></section><section id="pseudo-spectrum"class="mb-16"><h2 class="text-3xl font-bold border-b-4 border-cyan-500 pb-2 mb-8">何謂空間偽譜 (Spatial Pseudo-spectrum)？</h2><div class="bg-white p-8 rounded-xl shadow-lg grid md:grid-cols-2 gap-8 items-center"><div><p class="text-slate-600 leading-relaxed mb-4">除了 ESPRIT 之外，大多數 DOA 估計演算法並不會直接輸出角度估計值。它們的核心任務是生成一個稱為「空間偽譜」的函數 $P(θ)$。<p class="text-slate-600 leading-relaxed mb-6">我們透過掃描所有可能的角度 $θ$，計算出對應的 $P(θ)$ 值，然後尋找此函數圖形中的<strong class="text-cyan-600">峰值 (Peaks)</strong>，峰值所在的水平軸位置就是我們估計出的訊號到達方向 $\hat{θ}$。<div class="bg-amber-100 text-amber-800 p-4 rounded-lg"><h4 class="font-bold mb-2">"偽"譜的意義</h4><p class="text-sm">之所以稱之為「偽」譜，是因為它並非像傅立葉頻譜那樣代表真實的物理功率分布。它是一個純粹的數學構造，其設計目的就是在真實訊號方向上產生尖銳的峰值。例如，<span class="keyword"data-keyword="music">MUSIC</span> 演算法的偽譜在理想情況下，其峰值會趨近於無限大，這顯然不是功率值。</div></div><div class="bg-slate-100 p-6 rounded-xl flex flex-col items-center justify-center text-center shadow-inner"><h3 class="text-xl font-semibold text-slate-700 mb-4">輸入與輸出流程</h3><div class="w-full"><div class="mb-4"><p class="font-semibold text-rose-600">輸入 (Input)<div class="bg-white p-3 rounded-lg shadow-sm"><p class="text-lg font-mono">$\hat{R}_{xx}$<p class="text-xs text-slate-500">(樣本共變異數矩陣)</div></div><div class="flex justify-center my-2"><svg class="w-8 h-8 text-slate-400"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path stroke-linecap="round"stroke-linejoin="round"stroke-width="2"d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg></div><div class="mb-4"><div class="border-2 border-dashed border-slate-400 p-3 rounded-lg"><p class="text-lg font-semibold text-slate-600">演算法<p class="text-xs text-slate-500">(Bartlett, Capon, MUSIC...)</div></div><div class="flex justify-center my-2"><svg class="w-8 h-8 text-slate-400"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path stroke-linecap="round"stroke-linejoin="round"stroke-width="2"d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg></div><div><p class="font-semibold text-emerald-600">輸出 (Output)<div class="bg-white p-3 rounded-lg shadow-sm"><p class="text-lg font-mono">$P(θ)$<p class="text-xs text-slate-500">(空間偽譜)</div></div></div></div></div></section><section id="steering-vector-explanation"class="mb-16"><div class="bg-white p-8 rounded-xl shadow-lg"><h2 class="text-2xl font-bold text-slate-800 mb-4">核心概念：<span class="keyword"data-keyword="steering-vector">導向向量</span>的物理意義</h2><div class="grid md:grid-cols-2 gap-8 items-start"><div><p class="text-slate-600 mb-4">在深入演算法之前，必須理解為何 <span class="font-mono text-cyan-700">$a^H(θ)$</span> 這個運算如此重要。它不僅是數學符號，更代表了整個空間訊號處理的核心精神：<strong class="text-slate-700">空間匹配濾波 (Spatial Matched Filtering)</strong>。<p class="text-slate-600">您可以將 <span class="font-mono text-cyan-700">$a(θ)$</span> 想像成一個「模板」，它精確描述了一個來自方向 $θ$ 的理想訊號應有的相位模式。而運算 <span class="font-mono text-cyan-700">$a^H(θ)x$</span> 的物理意義就是：<ul class="list-disc list-inside mt-4 space-y-2 text-slate-700"><li>將實際接收到的混亂訊號 $x$。<li>投影到這個方向為 $θ$ 的「理想模板」上。<li>計算其「匹配程度」。如果 $x$ 中含有來自 $θ$ 方向的強訊號，這個投影結果（內積）的值就會很大。</ul></div><div class="bg-slate-50 p-6 rounded-lg border border-slate-200"><h3 class="font-semibold text-lg text-slate-700 mb-3">為什麼是 $a^H(θ)$ 而不是 $a^T(θ)$？</h3><p class="text-sm text-slate-500">在處理複數訊號時，必須使用 <strong>Hermitian 轉置 (H)</strong> 來取代實數世界中的一般轉置 (T)。<p class="text-sm text-slate-500 mt-3">這是為了正確計算訊號的「功率」。一個複數向量 $v$ 的功率（或能量）定義為 $|v|^2 = v^H v$。這個運算確保結果：<ol class="list-decimal list-inside text-sm text-slate-500 mt-2 space-y-1"><li><strong>結果為實數：</strong> 功率是一個物理量，必須是實數。$v^H v$ 永遠是實數，但 $v^T v$ 則未必。<li><strong>符合內積定義：</strong> 這是複數向量空間中內積的標準定義，它衡量了向量間的相似度。</ol><p class="text-sm text-slate-500 mt-3">因此，公式中的 $|a^H(θ)x|^2$ 就是在計算接收訊號 $x$ 在「$θ$ 方向模板」上的投影功率有多大。</div></div></div></section><section id="algorithms"class="mb-16"><h2 class="text-3xl font-bold border-b-4 border-cyan-500 pb-2 mb-8">演算法演進之路</h2><div class="relative pl-8 border-l-2 border-slate-300"><div class="mb-12"><div class="absolute w-6 h-6 bg-cyan-500 rounded-full -left-3 border-4 border-white"></div><h3 class="text-2xl font-semibold text-cyan-700 mb-4">階段一：傳統波束成形 (空間濾波)</h3><div class="grid md:grid-cols-2 gap-8"><div class="bg-white p-6 rounded-xl shadow-md"><h4 class="font-bold text-lg">2.1 週期圖法 (Periodogram, DFT)</h4><p class="text-sm text-slate-500 mb-3">最直接的方法，如同用一個「空間濾波器」掃描整個空間。對於 ULA，此操作對應於對空間頻率 $k d \sinθ$ 的掃描。<div class="bg-slate-100 p-4 rounded-lg mb-3"><span>$$P_{DFT}(θ) = |a^H(θ)x|^2$$</span></div><div class="text-sm"><p><strong class="text-red-600">缺點：</strong>解析度受限於陣列物理孔徑 (<span class="keyword"data-keyword="rayleigh-limit">瑞利極限</span>)，且單一快照易受雜訊影響，變異數高。</div></div><div class="bg-white p-6 rounded-xl shadow-md"><h4 class="font-bold text-lg">2.2 巴特利特法 (Bartlett Method)</h4><p class="text-sm text-slate-500 mb-3">傳統波束成形的多快照版本，透過平均來降低變異數。<div class="bg-slate-100 p-4 rounded-lg mb-3"><span>$$P_{Bartlett}(θ) = a^H(θ)\hat{R}_{xx}a(θ)$$</span></div><div class="text-sm"><p><strong class="text-green-600">優點：</strong>降低了變異數，譜面更平滑穩定。<p><strong class="text-red-600">缺點：</strong>解析度與 DFT 同樣受限於陣列孔徑。</div></div></div></div><div class="mb-12"><div class="absolute w-6 h-6 bg-indigo-500 rounded-full -left-3 border-4 border-white"></div><h3 class="text-2xl font-semibold text-indigo-700 mb-4">階段二：<span class="keyword"data-keyword="adaptive-beamforming">適應性波束成形</span> (資料相依)</h3><div class="grid md:grid-cols-1 gap-8"><div class="bg-white p-6 rounded-xl shadow-md"><h4 class="font-bold text-lg">2.3 卡朋法 (Capon) / MVDR</h4><p class="text-sm text-slate-500 mb-3">革命性進步！此方法也稱為最小變異數無失真響應 (Minimum Variance Distortionless Response, MVDR)。它利用資料的統計特性 ($\hat{R}_{xx}^{-1}$) 來設計「智慧」濾波器，能主動抑制干擾源。<div class="bg-slate-100 p-4 rounded-lg mb-3"><span>$$P_{Capon}(θ) = \frac{1}{a^H(θ)\hat{R}_{xx}^{-1}a(θ)}$$</span></div><div class="text-sm"><p><strong class="text-green-600">優點：</strong>資料適應性，能形成更窄的波束，解析度遠高於巴特利特法。<p><strong class="text-red-600">缺點：</strong>計算複雜度增加 (矩陣求逆)，且對陣列校準誤差、快照數量不足等模型失配問題敏感。</div></div></div></div><div class="mb-12"><div class="absolute w-6 h-6 bg-emerald-500 rounded-full -left-3 border-4 border-white"></div><h3 class="text-2xl font-semibold text-emerald-700 mb-4">階段三：<span class="keyword"data-keyword="subspace">子空間法</span> (超解析度)</h3><p class="mb-6 text-slate-600">典範轉移！不再是濾波，而是利用<span class="keyword"data-keyword="covariance">共變異數矩陣</span>的<span class="keyword"data-keyword="eigen-decomposition">特徵分解</span>，將空間切分為「<span class="keyword"data-keyword="signal-subspace">訊號子空間</span>」與「<span class="keyword"data-keyword="noise-subspace">雜訊子空間</span>」，並利用其「正交性」來找出訊號方向。<div class="bg-white p-6 rounded-xl shadow-md mb-8"><h4 class="font-bold text-lg mb-4 text-center">演算法解析度比較示意圖</h4><canvas id="resolutionCanvas"class="w-full"style="max-width:400px;height:250px;margin:0 auto"></canvas><div class="grid grid-cols-2 gap-4 mt-4 text-sm"><div><label for="separationSlider"class="font-medium">訊號源間距: <span id="separationValue"class="font-bold text-indigo-600">30</span>°</label> <input id="separationSlider"type="range"min="5"max="50"value="30"class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer"></div><div><label for="snrSlider"class="font-medium">訊雜比 (SNR): <span id="snrValue"class="font-bold text-indigo-600">15</span> dB</label> <input id="snrSlider"type="range"min="0"max="20"value="15"class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer"></div></div></div><div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"><div class="bg-white p-6 rounded-xl shadow-md"><h4 class="font-bold text-lg">3.3 皮薩倫科諧波分解 (PHD)</h4><p class="text-sm text-slate-500 mb-3"><span class="keyword"data-keyword="subspace">子空間法</span>的先驅 (Pisarenko Harmonic Decomposition)。它直接利用訊號方向與「最小特徵值對應的特徵向量 $e_{min}$」正交的特性。<div class="bg-slate-100 p-4 rounded-lg mb-3"><span>$$P_{PHD}(θ) = \frac{1}{|a^H(θ)e_{min}|^2}$$</span></div><div class="text-sm"><p><strong class="text-red-600">缺點：</strong>僅使用一個特徵向量，對雜訊與有限樣本的估計誤差非常敏感，結果不穩定。</div></div><div class="bg-white p-6 rounded-xl shadow-md"><h4 class="font-bold text-lg">3.4 <span class="keyword"data-keyword="music">MUSIC</span> (Multiple Signal Classification)</h4><p class="text-sm text-slate-500 mb-3">PHD 的強力升級版，利用「整個<span class="keyword"data-keyword="noise-subspace">雜訊子空間</span> $E_n$」來進行正交性檢驗，效果更穩健。<div class="bg-slate-100 p-4 rounded-lg mb-3"><span>$$P_{MUSIC}(θ) = \frac{1}{a^H(θ)E_nE_n^H a(θ)}$$</span></div><div class="text-sm"><p><strong class="text-green-600">優點：</strong>透過平均效應，結果非常穩健，是高解析度估計的標竿。<p><strong class="text-red-600">缺點：</strong>需預先估測訊號源數量 $D$；對<span class="keyword"data-keyword="coherent">同調訊號源</span>失效 (需<span class="keyword"data-keyword="spatial-smoothing">空間平滑</span>)。</div></div><div class="bg-emerald-100 text-emerald-900 p-6 rounded-xl shadow-md md:col-span-2 lg:col-span-1"><h4 class="font-bold text-lg">核心概念：子空間分解</h4><p class="text-sm mb-3">在白雜訊假設下，$R_{xx}$ 的特徵值分為兩部分：<ul class="space-y-2 text-sm"><li><strong class="block"><span class="keyword"data-keyword="signal-subspace">訊號子空間</span> (U<sub>s</sub>)</strong> 由 D 個 $> \sigma^2$ 的特徵值對應的特徵向量張成。真實訊號的 $a(θ)$ 皆落於此。<li><strong class="block"><span class="keyword"data-keyword="noise-subspace">雜訊子空間</span> (E<sub>n</sub>)</strong> 由 M-D 個 $≈ \sigma^2$ 的特徵值對應的特徵向量張成。</ul><p class="mt-3 font-semibold text-center text-lg">$a(θ_{true}) \perp E_{n}$</div></div></div><div class="mb-12"><div class="absolute w-6 h-6 bg-rose-500 rounded-full -left-3 border-4 border-white"></div><h3 class="text-2xl font-semibold text-rose-700 mb-4">階段四：旋轉不變性 (無搜尋)</h3><div class="grid md:grid-cols-1 gap-8"><div class="bg-white p-6 rounded-xl shadow-md"><h4 class="font-bold text-lg">4.1 <span class="keyword"data-keyword="esprit">ESPRIT</span> (Estimation of Signal Parameters via Rotational Invariance Techniques)</h4><p class="text-sm text-slate-500 mb-4">另一種典範轉移！保留了<span class="keyword"data-keyword="subspace">子空間法</span>的高解析度，但透過特殊的陣列設計來避免耗時的頻譜搜尋，直接透過解特徵值問題來計算角度。<div class="bg-rose-50 p-4 rounded-lg border border-rose-200 space-y-4"><div><h5 class="font-semibold text-rose-800">理論基礎</h5><p class="text-sm text-slate-600 mt-1">ESPRIT 利用了陣列的特殊結構：它必須由兩個完全相同、但存在一個已知平移向量 Δ 的子陣列構成。這種「平移不變性」的幾何特性，會在<span class="keyword"data-keyword="signal-subspace">訊號子空間</span>中引入一種可利用的「旋轉不變性」。<p class="text-sm text-slate-600 mt-2">令 $U_{s1}$ 和 $U_{s2}$ 分別是從兩個子陣列資料得到的<span class="keyword"data-keyword="signal-subspace">訊號子空間</span>基底。它們之間存在一個唯一的非奇異轉換矩陣 $\Psi$，使得它們的關係如下：<div class="text-center bg-white p-2 my-2 rounded"><span>$$ U_{s2} = U_{s1}\Psi $$</span></div><p class="text-sm text-slate-600">ESPRIT 的核心洞見在於，轉換矩陣 $\Psi$ 的特徵值，其相位 (phase) 就直接對應了訊號源到達方向的角度資訊。</div><hr><div><h5 class="font-semibold text-rose-800">求解與使用時機</h5><p class="text-sm text-slate-600 mt-1">演算法透過求解上述方程（通常使用總最小二乘法 TLS-ESPRIT）來得到矩陣 $\Psi$，再對 $\Psi$ 進行<span class="keyword"data-keyword="eigen-decomposition">特徵分解</span>。從其特徵值的相位中，便可以直接計算出到達角，無需進行空間頻譜搜尋。</div></div><div class="text-sm mt-4 space-y-2"><p><strong class="text-green-600">優點：</strong>計算效率極高。當需要高精度且陣列結構符合要求時，ESPRIT 是規避 <span class="keyword"data-keyword="music">MUSIC</span> 龐大搜尋成本的最佳選擇。<p><strong class="text-red-600">缺點：</strong>對陣列幾何有嚴格要求 (必須具備平移不變性)，對校準誤差敏感，且同樣需處理<span class="keyword"data-keyword="coherent">同調訊號源</span>問題。</div></div></div></div></div></section><section id="chapter5"class="mb-16"><h2 class="text-3xl font-bold border-b-4 border-cyan-500 pb-2 mb-8">第五章：綜合與比較框架</h2><div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto"><table class="w-full text-sm text-left text-slate-500"><thead class="text-xs text-slate-700 uppercase bg-slate-100"><tr><th scope="col"class="px-6 py-3">演算法<th scope="col"class="px-6 py-3">核心原理<th scope="col"class="px-6 py-3">解析度<th scope="col"class="px-6 py-3">計算複雜度<th scope="col"class="px-6 py-3">對<span class="keyword"data-keyword="coherent">同調訊號源</span><tbody><tr class="bg-white border-b hover:bg-slate-50"><th scope="row"class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">週期圖法 / DFT<td class="px-6 py-4">傳統波束掃描<td class="px-6 py-4 text-red-600">低 (孔徑受限)<td class="px-6 py-4 text-green-600">極低<td class="px-6 py-4">可形成波束，但難分辨<tr class="bg-slate-50 border-b hover:bg-slate-100"><th scope="row"class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">巴特利特法<td class="px-6 py-4">平均化波束成形<td class="px-6 py-4 text-red-600">低 (≈DFT)，變異數較低<td class="px-6 py-4 text-green-600">低<td class="px-6 py-4">同上<tr class="bg-white border-b hover:bg-slate-50"><th scope="row"class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">卡朋法 / MVDR<td class="px-6 py-4"><span class="keyword"data-keyword="adaptive-beamforming">適應性波束成形</span><td class="px-6 py-4 text-yellow-600">中-高 (依條件)<td class="px-6 py-4 text-yellow-600">中 (需逆矩陣)<td class="px-6 py-4">可，但效能下降 (<span class="keyword"data-keyword="spatial-smoothing">空間平滑</span>可改善)<tr class="bg-slate-50 border-b hover:bg-slate-100"><th scope="row"class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap"><span class="keyword"data-keyword="music">MUSIC</span><td class="px-6 py-4">子空間正交性 + 搜尋<td class="px-6 py-4 text-green-600">非常高<td class="px-6 py-4 text-red-600">高 (EVD + 搜尋)<td class="px-6 py-4 text-red-600">差 (需<span class="keyword"data-keyword="spatial-smoothing">空間平滑</span>)<tr class="bg-white hover:bg-slate-50"><th scope="row"class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap"><span class="keyword"data-keyword="esprit">ESPRIT</span><td class="px-6 py-4">子陣列旋轉不變性<td class="px-6 py-4 text-green-600">非常高<td class="px-6 py-4 text-yellow-600">中 (無搜尋)<td class="px-6 py-4 text-red-600">差 (需<span class="keyword"data-keyword="spatial-smoothing">空間平滑</span>)</table></div></section><section id="visualization-guide"class="mb-16"><h2 class="text-3xl font-bold border-b-4 border-cyan-500 pb-2 mb-8">視覺化實作指引</h2><div class="bg-white p-8 rounded-xl shadow-lg"><p class="text-slate-600 mb-6">為了更直觀地理解與比較這些演算法，在進行模擬視覺化時，可以參考以下關鍵點：<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 text-sm"><div class="bg-slate-50 p-4 rounded-lg"><h4 class="font-semibold text-slate-700 mb-2">譜值正規化</h4><p class="text-slate-600">將偽譜轉換為分貝 (dB) 單位，並將峰值對齊 0 dB，即 $10\log_{10}(P(θ) / \max P(θ))$，有助於觀察動態範圍與旁瓣細節。</div><div class="bg-slate-50 p-4 rounded-lg"><h4 class="font-semibold text-slate-700 mb-2">快照數量影響</h4><p class="text-slate-600">比較不同快照數 $L$ (如 16, 64, 256) 對 $\hat{R}_{xx}$ 估計品質的影響，觀察偽譜噪底、峰值穩定性的變化。</div><div class="bg-slate-50 p-4 rounded-lg"><h4 class="font-semibold text-slate-700 mb-2">模型階數選擇</h4><p class="text-slate-600">對於子空間法，訊號源數量 $D$ 的估測至關重要。可使用 AIC/MDL 等資訊準則來自動估測，避免模型失配。</div><div class="bg-slate-50 p-4 rounded-lg"><h4 class="font-semibold text-slate-700 mb-2"><span class="keyword"data-keyword="coherent">同調訊號源</span>處理</h4><p class="text-slate-600">展示未使用與使用<span class="keyword"data-keyword="spatial-smoothing">空間平滑</span>技術時，MUSIC/ESPRIT 對同調訊號的解析能力差異。</div><div class="bg-slate-50 p-4 rounded-lg"><h4 class="font-semibold text-slate-700 mb-2">穩健性技巧</h4><p class="text-slate-600">為 Capon 引入對角裝載 ($ \hat{R}_{xx} + \alpha I $)；為子空間法引入前後向平均，觀察其在低快照或低 SNR 下的效能改善。</div><div class="bg-slate-50 p-4 rounded-lg"><h4 class="font-semibold text-slate-700 mb-2">圖表參數標註</h4><p class="text-slate-600">在所有模擬圖上清晰標註 $M, d/\lambda, L, \text{SNR}$ 及真實訊號角度等參數，以提高圖表的可讀性與可重現性。</div></div></div></section><section id="conclusion"><div class="bg-gradient-to-r from-slate-700 to-slate-900 text-white p-8 rounded-xl shadow-2xl"><h3 class="text-2xl font-bold mb-4">結論：經典演算法在現代的意義</h3><p class="text-slate-300">這些經典演算法不僅是歷史，更是現代智慧感測系統的基石。在深度學習時代，它們常被用來生成強大的、融合物理知識的「特徵圖」，作為神經網路的輸入。掌握這些基礎原理，是通往下一代訊號處理技術的必經之路。</div></section></main><footer class="bg-slate-800 text-slate-300 mt-16 text-center py-6"><div class="container mx-auto"><p class="mb-2"><a href="https://wellstsai.com"target="_blank"rel="noopener noreferrer"class="hover:text-cyan-400 transition-colors">Generated by wellstsai.com</a><p class="text-sm text-slate-400">撰寫日期：2025年10月02日</div></footer><div id="keyword-modal"class="fixed inset-0 z-50 flex items-center justify-center p-4 hidden"aria-hidden="true"role="dialog"aria-modal="true"><div id="modal-backdrop"class="fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300 ease-in-out opacity-0"></div><div id="modal-panel"class="relative bg-slate-50/80 backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl text-slate-800 glass-border transition-all duration-300 ease-in-out opacity-0 scale-95"><div class="p-6 md:p-8"><div class="flex justify-between items-center pb-4 border-b border-slate-500/20"><h3 id="modal-title"class="text-2xl font-bold gradient-text"></h3><button id="modal-close-button"aria-label="關閉"class="text-slate-500 hover:text-slate-900 transition-colors"><svg class="w-6 h-6"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path stroke-linecap="round"stroke-linejoin="round"stroke-width="2"d="M6 18L18 6M6 6l12 12"/></svg></button></div><div id="modal-content"class="mt-4 text-slate-600 leading-relaxed space-y-4"></div></div></div></div><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1});const e=document.getElementById("steeringVectorCanvas"),t=e.getContext("2d"),n=document.getElementById("angleSlider"),a=document.getElementById("angleValue");function o(e){const t=e.getBoundingClientRect(),n=window.devicePixelRatio||1;e.width=t.width*n,e.height=t.height*n;return e.getContext("2d").scale(n,n),{width:t.width,height:t.height}}let s=o(e),i=s.width,l=s.height;function d(){const e=parseFloat(n.value),o=e*Math.PI/180;a.textContent=e.toFixed(0),t.clearRect(0,0,i,l),t.fillStyle="#f1f5f9",t.fillRect(0,0,i,l);const s=l/2-20,d=(i-105)/2;for(let e=0;e<4;e++)t.beginPath(),t.arc(d+35*e,s,5,0,2*Math.PI),t.fillStyle="#0891b2",t.fill();t.strokeStyle="#38bdf8",t.lineWidth=1.5,t.save(),t.translate(i/2,s),t.rotate(o);for(let e=-5;e<=5;e++)t.beginPath(),t.moveTo(25*e,-l),t.lineTo(25*e,l),t.stroke();t.restore();for(let e=0;e<4;e++){const n=35*e,a=-2*Math.PI*n/50*Math.sin(o),i=d+n,l=s+65,r=35,c=30;t.strokeStyle="#475569",t.lineWidth=1,t.strokeRect(i-r/2,l-c/2,r,c),t.beginPath(),t.strokeStyle="#ef4444",t.moveTo(i-r/2,l+Math.cos(a)*(c/2-2));for(let e=1;e<=r;e++){const n=e/r*2*Math.PI,o=Math.cos(2*n+a)*(c/2-2);t.lineTo(i-r/2+e,l+o)}t.stroke()}}n.addEventListener("input",d),d();const r=document.getElementById("resolutionCanvas"),c=r.getContext("2d"),p=document.getElementById("separationSlider"),m=document.getElementById("separationValue"),y=document.getElementById("snrSlider"),h=document.getElementById("snrValue");let u=o(r),g=u.width,w=u.height;function f(e,t,n,a){const o=-Math.pow(e-t,2)/(2*Math.pow(n,2));return a*Math.exp(o)}function k(){const e=parseFloat(p.value),t=parseFloat(y.value);m.textContent=e.toFixed(0),h.textContent=t.toFixed(0),c.clearRect(0,0,g,w);const n=30,a=g-60,o=w-60;c.beginPath(),c.strokeStyle="#94a3b8",c.moveTo(n,n),c.lineTo(n,w-n),c.lineTo(g-n,w-n),c.stroke(),c.fillStyle="#64748b",c.fillText("角度 θ",g/2-15,w-5),c.save(),c.rotate(-Math.PI/2),c.fillText("偽譜 P(θ)",-w/2-20,15),c.restore();const s=-e/2,i=e/2,l=30/(Math.pow(10,t/10)+1),d=[{name:"Bartlett",color:"#f87171"},{name:"Capon",color:"#a78bfa"},{name:"MUSIC",color:"#34d399"}];d.forEach((e,t)=>{c.fillStyle=e.color,c.fillRect(g-n-70,n+20*t,10,10),c.fillStyle="#64748b",c.fillText(e.name,g-n-55,n+20*t+9)}),d.forEach(e=>{c.beginPath(),c.strokeStyle=e.color,c.lineWidth=2.5;for(let t=0;t<=a;t++){const d=100*(t/a-.5);let r,p,m=0;switch(e.name){case"Bartlett":r=18,p=.6;break;case"Capon":r=8+.5*l,p=.8;break;case"MUSIC":r=1.5+.2*l,p=1}m=f(d,s,r,p)+f(d,i,r,p);const y=n+t,h=w-n-m*(.8*o);0===t?c.moveTo(y,h):c.lineTo(y,h)}c.stroke()})}p.addEventListener("input",k),y.addEventListener("input",k),k(),window.addEventListener("resize",()=>{s=o(e),i=s.width,l=s.height,d(),u=o(r),g=u.width,w=u.height,k()})}),(()=>{const e={doa:{title:"到達方向 (DOA)",content:"<p>到達方向 (Direction of Arrival, DOA) 是一項利用感測器陣列來確定遠場訊號發射源空間方位的技術，為雷達、聲納和無線通訊的核心。</p>"},manifold:{title:"陣列流形矩陣 A(θ)",content:"<p>一個關鍵的 M x D 維矩陣，其每一行都是一個對應特定訊號源的導向向量。它完整描述了陣列的幾何結構如何對所有來源訊號產生相位響應，是連接訊號源物理位置與接收資料的橋樑。</p>"},"steering-vector":{title:"導向向量 a(θ)",content:"<p>一個 M x 1 維的複數向量，將訊號源的「空間角度 θ」這個物理量，編碼為陣列上 M 個感測器所接收訊號之間的「相位關係」。它是空間感知的最基本單位。</p>"},covariance:{title:"空間協方差矩陣 Rxx",content:"<p>描述陣列接收訊號在空間維度上的二階統計特性。透過對多個時間快照取平均，可以有效抑制隨機雜訊、強化訊號本身的結構，是所有現代高階 DOA 估計演算法的基礎。</p>"},scm:{title:"樣本協方差矩陣 R̂xx",content:"<p>在實務中，我們無法得知真實的協方差矩陣，因此透過有限數量 (L) 的快照來估計它，稱為樣本協方差矩陣。SCM 的估計品質（取決於快照數量 L 和訊雜比）直接影響演算法的最終效能。</p>"},"pseudo-spectrum":{title:"空間偽譜 P(θ)",content:"<p>多數 DOA 演算法的輸出結果。它是一個以掃描角度 θ 為變數的函數，其峰值 (peaks) 便對應估計出的訊號來源方向。它並非真實的「功率譜」，而是一個為了在特定角度上能呈現尖銳峰值以便偵測的數學構造。</p>"},"rayleigh-limit":{title:"瑞利極限",content:"<p>傳統光學或波束成形方法的理論解析度極限，此極限受限於觀測孔徑（陣列大小）與訊號波長。若兩個訊號源的角度間距小於此極限，傳統方法將無法將其分辨為兩個獨立的訊號源。</p>"},"adaptive-beamforming":{title:"適應性波束成形",content:"<p>如卡朋法，或稱最小變異數無失真響應 (MVDR)，這類方法利用接收到的資料統計特性（協方差矩陣）來「自適應地」設計空間濾波器。它能夠在干擾訊號的方向上智慧地形成零點（nulls），從而達到比傳統固定濾波器更高的解析度與抗干擾能力。</p>"},subspace:{title:"子空間法",content:'<p>一類高解析度演算法（如 MUSIC, ESPRIT）的總稱。它們不再使用空間濾波，而是透過對協方差矩陣進行<span class="keyword" data-keyword="eigen-decomposition">特徵分解</span>，將觀測空間劃分為「<span class="keyword" data-keyword="signal-subspace">訊號子空間</span>」和「<span class="keyword" data-keyword="noise-subspace">雜訊子空間</span>」，並利用兩者之間的正交性來精確地定位訊號源，在足夠 SNR、樣本數充足且模型匹配的條件下，常可超越傳統<span class="keyword" data-keyword="rayleigh-limit">瑞利極限</span>的分辨力（super-resolution）。</p>'},"signal-subspace":{title:"訊號子空間",content:'<p>由協方差矩陣中 D 個較大的特徵值所對應的特徵向量張成的 D 維空間。在理想情況下，所有真實訊號的<span class="keyword" data-keyword="steering-vector">導向向量</span>都完全位於此子空間內。</p>'},"noise-subspace":{title:"雜訊子空間",content:'<p>由協方差矩陣中 M-D 個等於雜訊功率的最小特徵值所對應的特徵向量張成的 M-D 維空間。它的最重要特性是與<span class="keyword" data-keyword="signal-subspace">訊號子空間</span>完全正交。</p>'},"eigen-decomposition":{title:"特徵分解",content:'<p>一種將一個方陣分解為一組特徵值和對應的特徵向量的數學工具。在子空間法中，對<span class="keyword" data-keyword="covariance">協方差矩陣</span>進行特徵分解是分離訊號與雜訊資訊、進而劃分出訊號與雜訊子空間的關鍵步驟。</p>'},music:{title:"MUSIC (Multiple Signal Classification)",content:'<p>多重訊號分類 (Multiple Signal Classification) 的縮寫，是一種經典的高解析度子空間方法。它利用整個<span class="keyword" data-keyword="noise-subspace">雜訊子空間</span>的資訊，透過搜尋哪個角度的<span class="keyword" data-keyword="steering-vector">導向向量</span>最接近與雜訊子空間正交，來估計 DOA。其結果穩健且解析度極高，常作為業界標竿。</p>'},esprit:{title:"ESPRIT",content:'<p>參數估計訊號參數 (Estimation of Signal Parameters via Rotational Invariance Techniques) 的縮寫。它是一種高效率的<span class="keyword" data-keyword="subspace">子空間法</span>，要求陣列具有特殊的平移不變性（如由兩個相同的位移子陣列構成）。這個幾何特性讓演算法可以避免 <span class="keyword" data-keyword="music">MUSIC</span> 耗時的角度搜尋，直接透過解一個廣義特徵值問題來計算出 DOA。</p>'},coherent:{title:"同調訊號源 (Coherent Sources)",content:"<p>指兩個或多個訊號源之間具有固定的相位關係，通常發生在多路徑傳播場景。這種相關性會導致訊號協方差矩陣降秩 (rank-deficient)，使得 MUSIC/ESPRIT 等標準子空間法失效，無法分辨訊號源。</p>"},"spatial-smoothing":{title:"空間平滑 (Spatial Smoothing)",content:'<p>一種針對<span class="keyword" data-keyword="coherent">同調訊號源</span>的預處理技術，常用於 ULA。它將整個陣列劃分為多個重疊的子陣列，計算每個子陣列的協方差矩陣並將其平均。這個過程可以有效地「去相關」，恢復協方差矩陣的滿秩特性，從而使 MUSIC/ESPRIT 等演算法能重新正常工作。</p>'}},t=document.getElementById("keyword-modal"),n=document.getElementById("modal-backdrop"),a=document.getElementById("modal-panel"),o=document.getElementById("modal-title"),s=document.getElementById("modal-content"),i=document.getElementById("modal-close-button"),l=()=>{document.body.style.overflow="",n.classList.add("opacity-0"),a.classList.add("opacity-0","scale-95"),t.setAttribute("aria-hidden","true");const e=()=>{t.classList.add("hidden"),a.removeEventListener("transitionend",e)};a.addEventListener("transitionend",e)};document.addEventListener("click",d=>{const r=d.target.closest(".keyword");if(r&&r.dataset.keyword)return(i=>{const l=e[i];l&&(o.textContent=l.title,s.innerHTML=l.content,document.body.style.overflow="hidden",t.classList.remove("hidden"),t.setAttribute("aria-hidden","false"),requestAnimationFrame(()=>{n.classList.remove("opacity-0"),a.classList.remove("opacity-0","scale-95")}))})(r.dataset.keyword);d.target.closest("#modal-panel")&&d.target!==i&&!d.target.closest("#modal-close-button")||"false"===t.getAttribute("aria-hidden")&&l()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&"false"===t.getAttribute("aria-hidden")&&l()})})()</script>