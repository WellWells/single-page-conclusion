<!doctypehtml><html lang="zh-TW"><meta name="twitter:image"content="https://wellstsai.com/single-page-conclusion/%E7%B7%9A%E6%80%A7%E6%93%AC%E5%90%88%E5%81%8F%E8%AA%A4-OLS%E8%88%87PCA%E4%B9%8B%E6%AF%94%E8%BC%83.png"><meta name="twitter:description"content="探討普通最小平方法在高雜訊數據下的擬合差異。說明迴歸稀釋現象如何導致斜率偏低，並對比正交回歸在捕捉數據長軸方向的幾何優勢。"><meta name="twitter:title"content="線性擬合偏誤-OLS與PCA之比較"><meta name="twitter:card"content="summary_large_image"><meta property="og:type"content="article"><meta property="og:site_name"content="WellWells"><meta property="og:image"content="https://wellstsai.com/single-page-conclusion/%E7%B7%9A%E6%80%A7%E6%93%AC%E5%90%88%E5%81%8F%E8%AA%A4-OLS%E8%88%87PCA%E4%B9%8B%E6%AF%94%E8%BC%83.png"><meta property="og:url"content="https://wellstsai.com/single-page-conclusion/%E7%B7%9A%E6%80%A7%E6%93%AC%E5%90%88%E5%81%8F%E8%AA%A4-OLS%E8%88%87PCA%E4%B9%8B%E6%AF%94%E8%BC%83.html"><meta property="og:description"content="探討普通最小平方法在高雜訊數據下的擬合差異。說明迴歸稀釋現象如何導致斜率偏低，並對比正交回歸在捕捉數據長軸方向的幾何優勢。"><meta property="og:title"content="線性擬合偏誤-OLS與PCA之比較"><meta name="description"content="探討普通最小平方法在高雜訊數據下的擬合差異。說明迴歸稀釋現象如何導致斜率偏低，並對比正交回歸在捕捉數據長軸方向的幾何優勢。"><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><title>線性擬合的視覺偏誤：OLS vs TLS (PCA)</title><script src="https://cdn.tailwindcss.com"></script><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script><link rel="stylesheet"href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css"><script defer="defer"src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script><script defer="defer"src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})'></script><style>@import url(https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap);body{font-family:Inter,sans-serif}.canvas-container{position:relative;height:550px;width:100%}.btn-active-ols{background-color:#2563eb!important;color:#fff!important}.btn-active-pca{background-color:#10b981!important;color:#fff!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-JKC4KZLT26"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JKC4KZLT26")</script><body class="bg-slate-50 text-slate-900 leading-relaxed"><div class="max-w-7xl mx-auto px-4 py-12"><header class="mb-12 text-center"><h1 class="text-4xl font-bold text-slate-800 mb-4">為什麼線性擬合看起來「歪歪的」？</h1><p class="text-xl text-slate-600">探討 <strong>Ordinary Least Squares（OLS）</strong> 與 <strong>Total Least Squares（TLS）/ Principal Component Analysis（PCA）</strong> 在高雜訊資料下的直覺差異</header><div class="grid grid-cols-1 lg:grid-cols-12 gap-8"><div class="lg:col-span-7 bg-white p-6 rounded-2xl shadow-xl border border-slate-200"><div class="flex flex-wrap gap-3 mb-6"><button id="btn-ols"class="px-5 py-2 border-2 border-blue-600 text-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition">OLS 垂直</button> <button id="btn-pca"class="px-5 py-2 border-2 border-emerald-600 text-emerald-600 rounded-lg font-semibold hover:bg-emerald-50 transition">PCA 正交</button> <button id="btn-both"class="px-5 py-2 bg-slate-800 text-white rounded-lg font-semibold hover:bg-slate-900 transition">同時顯示</button> <button id="btn-hide"class="px-5 py-2 bg-slate-200 text-slate-700 rounded-lg font-semibold hover:bg-slate-300 transition">隱藏擬合線</button> <button id="btn-reset"class="px-5 py-2 border border-slate-300 text-slate-500 rounded-lg hover:bg-slate-100 transition ml-auto">重新生成資料 (N=5000)</button></div><div class="canvas-container"><canvas id="mainChart"></canvas></div><div class="mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 text-sm italic text-slate-500 flex justify-between"><span>提示：在高雜訊下，OLS 斜率會明顯向 X 軸（水平）偏移。</span> <span id="data-info">資料點數量: 0</span></div></div><div class="lg:col-span-5 space-y-8"><section><h2 class="text-2xl font-bold text-slate-800 border-l-4 border-blue-500 pl-3 mb-4">核心教學：高雜訊下的偏誤</h2><div class="space-y-4 text-slate-700"><p>當資料點增加且雜訊變大時，<strong>普通最小平方法（Ordinary Least Squares, OLS）</strong> 的限制會暴露得更明顯：<ul class="list-disc pl-5 space-y-2"><li><strong>迴歸稀釋（Regression Dilution）：</strong> 當 $X$ 軸存在隨機誤差（雜訊）時，$OLS$ 計算出的斜率會比真實趨勢更「扁平」。主因在於其僅最小化垂直方向的殘差，導致受 $X$ 軸方向寬度影響。<li><strong>$PCA$ 的幾何優勢：</strong> <strong>主成分分析（Principal Component Analysis, PCA）</strong> 考慮雙向變異數。在高雜訊資料雲中，能準確捕捉雲圖的「長軸」方向，視覺上較符合直覺。</ul></div></section><section><h2 class="text-2xl font-bold text-slate-800 border-l-4 border-amber-500 pl-3 mb-4">迴歸均值（Regression to the Mean）</h2><div class="space-y-4 text-slate-700"><p>$OLS$ 的擬合線看起來「偏低」為數學必然結果。當 $X$ 增加一個單位時，$Y$ 平均增加量（斜率）受制於隨機雜訊影響。<p>若使用「視覺直覺」的 $PCA$ 線進行預測，當 $X=2$ 時，$PCA$ 可能預測 $Y > 4$，但真實預測期望值 $E[Y|X=2]$ 僅約 $1.0$。<div class="bg-amber-50 p-4 rounded-lg border-l-4 border-amber-400 text-sm"><strong>💡 小提醒：</strong><br>若需預測未來數值，請信任 $OLS$（即使視覺上略顯偏差）；若需描述資料的幾何結構，則使用 $PCA$。</div><div class="mt-4 p-4 bg-red-50 border-l-4 border-red-400 text-sm text-red-700 rounded-r-lg"><strong>⚠️ 資料修正與驗證：</strong><br>比較上文提及之「PCA 預測 $Y > 4$」與底部統計資料（如 $PCA$ 斜率 $0.928$），可發現數值不一致。<br>此反映不同次模擬中的隨機變異。若依據底部資料 ($k_{PCA} \approx 0.93$) 計算，當 $X=2$ 時，$PCA$ 預測值應約為 $1.85$。<br>惟結論依然成立：<strong>$PCA$ 斜率遠大於 $OLS$</strong>，且易放大雜訊影響。</div></div></section><section><h2 class="text-2xl font-bold text-slate-800 border-l-4 border-emerald-500 pl-3 mb-4">統計資料對比</h2><div class="bg-white rounded-lg border border-slate-200 p-4 shadow-sm"><div class="grid grid-cols-2 gap-4"><div class="p-3 bg-blue-50 rounded-lg"><div class="text-xs text-blue-600 font-bold uppercase">OLS 斜率</div><div id="stat-ols-slope"class="text-2xl font-mono font-bold">-</div></div><div class="p-3 bg-emerald-50 rounded-lg"><div class="text-xs text-emerald-600 font-bold uppercase">PCA 斜率</div><div id="stat-pca-slope"class="text-2xl font-mono font-bold">-</div></div></div><p class="mt-4 text-xs text-slate-400">註：在高雜訊（資料雲越胖）時，兩者斜率差距越大。</div></section><section><h2 class="text-2xl font-bold text-slate-800 border-l-4 border-indigo-500 pl-3 mb-4">進階技術解析：專家觀點</h2><div class="space-y-6 text-slate-700"><div><h3 class="text-lg font-bold text-slate-800 mb-2">1. 資料標準化的必要性（Scaling is Crucial）</h3><p class="mb-2">文中提及之 <strong>Total Least Squares（TLS）</strong> / $PCA$ 幾何優勢，有其嚴格前提：<strong>$X$ 與 $Y$ 必須經過標準化（Standardization）</strong>，或兩者擁有相同的物理單位與雜訊變異數（Isotropic Noise）。<p class="text-sm bg-slate-100 p-3 rounded text-slate-600">假設 $X$ 單位為「公尺」，$Y$ 為「毫米」，資料分布將被拉伸成極其細長形狀，$PCA$ 將計算出垂直線（斜率 $\infty$），失去分析意義。相對地，$OLS$ 具備「仿射不變性（Affine Invariance）」，不受單位縮放影響。</div><div><h3 class="text-lg font-bold text-slate-800 mb-2">2. 為何預測應採用 $OLS$？（Why OLS for Prediction?）</h3><p class="mb-2">雖然 $PCA$ 還原「真實幾何結構」，但在<strong>預測任務</strong>中，成效往往不如 $OLS$。<ul class="list-disc pl-5 space-y-2"><li><strong>新資料亦含雜訊：</strong> 取得新 $X_{new}$ 進行預測時，該數值本身即包含雜訊。<li><strong>收縮估計（Shrinkage）：</strong> 若使用 $PCA$ 較陡峭之斜率，$X$ 的雜訊將被放大並傳遞給 $Y$。$OLS$ 較平緩之斜率產生「收縮效應」，抵消 $X$ 軸雜訊干擾，從而最小化預測之均方誤差（MSE）。</ul></div></div></section></div></div><section class="mt-12 bg-white p-8 rounded-2xl shadow-lg border border-slate-200"><h2 class="text-2xl font-bold mb-6 text-center text-slate-800">為何 $n=5000$ 具備統計意義？</h2><div class="max-w-3xl mx-auto text-slate-700 leading-relaxed space-y-4"><p>在大量資料下，隨機誤差呈現穩定分布。根據 <strong>大數法則（LLN）</strong>，可觀察到 $OLS$ 之預測線並非因樣本數不足而偏離，而是其<strong>數學定義</strong>注定朝 $y$ 平均值收縮（斜率趨向 $0$）。<p>若將資料旋轉 $90^\circ$，再次進行 $OLS$，將得到另一條截然不同之擬合線。而 $PCA$ 具「旋轉不變性」，無論資料如何旋轉，擬合線始終穿過資料核心長軸。</div></section><footer class="bg-slate-900 text-slate-400 text-center py-12 text-sm mt-12 mb-0 rounded-t-2xl"><div class="flex flex-col items-center justify-center space-y-2"><div>Generated by <a href="https://wellstsai.com"target="_blank"class="hover:text-white transition underline">wellstsai.com</a></div><div>撰寫日期：2026-01-05</div></div></footer></div><script>const N_POINTS=5e3;let rawData=[],chart=null,currentStats=null,config={showOls:!1,showPca:!1};function generateData(t=5e3){const e=[];for(let a=0;a<t;a++){const t=3*(2*Math.random()-1),a=35*t+60*(2*Math.random()-1)+150,o=35*t+45*(2*Math.random()-1)-100;e.push({x:a,y:o})}return document.getElementById("data-info").innerText=`資料點數量: ${t}`,e}function calculateStats(t){const e=t.length,a=t.reduce((t,e)=>t+e.x,0)/e,o=t.reduce((t,e)=>t+e.y,0)/e;let n=0,r=0,c=0;t.forEach(t=>{const e=t.x-a,s=t.y-o;n+=e*s,r+=e*e,c+=s*s});const s=n/r,l=o-s*a,i=[[r/(e-1),n/(e-1)],[n/(e-1),c/(e-1)]],d=math.eigs(i),u=d.values.valueOf(),p=d.vectors.valueOf()[u.indexOf(Math.max(...u))],h=p[1]/p[0],g=o-h*a;return document.getElementById("stat-ols-slope").innerText=s.toFixed(3),document.getElementById("stat-pca-slope").innerText=h.toFixed(3),{mx:a,my:o,olsSlope:s,olsIntercept:l,pcaSlope:h,pcaIntercept:g}}function initChart(){rawData=generateData(),currentStats=calculateStats(rawData);const t=rawData.map(t=>t.x),e=Math.min(...t),a=Math.max(...t),o=document.getElementById("mainChart").getContext("2d");chart=new Chart(o,{type:"scatter",data:{datasets:[{label:"資料點 (N=5000)",data:rawData,backgroundColor:"rgba(148, 163, 184, 0.25)",pointRadius:1.5,order:5},{label:"OLS 擬合線 (垂直最小化)",data:[{x:e,y:currentStats.olsSlope*e+currentStats.olsIntercept},{x:a,y:currentStats.olsSlope*a+currentStats.olsIntercept}],borderColor:"#2563eb",borderWidth:4,pointRadius:0,showLine:!0,hidden:!0,order:1},{label:"PCA / TLS 擬合線 (正交最小化)",data:[{x:e,y:currentStats.pcaSlope*e+currentStats.pcaIntercept},{x:a,y:currentStats.pcaSlope*a+currentStats.pcaIntercept}],borderColor:"#10b981",borderWidth:4,pointRadius:0,showLine:!0,hidden:!0,order:2}]},options:{responsive:!0,maintainAspectRatio:!1,animation:!1,scales:{x:{type:"linear",position:"bottom",grid:{color:"#f1f5f9"}},y:{type:"linear",grid:{color:"#f1f5f9"}}},plugins:{legend:{position:"top"}}},plugins:[{id:"custom-residuals",afterDraw:t=>{const{ctx:e,scales:{x:a,y:o}}=t;e.save();const n=!t.getDatasetMeta(1).hidden,r=!t.getDatasetMeta(2).hidden;rawData.slice(0,80).forEach(t=>{if(n&&(e.strokeStyle="rgba(37, 99, 235, 0.4)",e.lineWidth=1,e.beginPath(),e.moveTo(a.getPixelForValue(t.x),o.getPixelForValue(t.y)),e.lineTo(a.getPixelForValue(t.x),o.getPixelForValue(currentStats.olsSlope*t.x+currentStats.olsIntercept)),e.stroke()),r){e.strokeStyle="rgba(16, 185, 129, 0.4)",e.lineWidth=1;const n=currentStats.pcaSlope,r=currentStats.pcaIntercept,c=(t.x+n*t.y-n*r)/(1+n*n),s=n*c+r;e.beginPath(),e.moveTo(a.getPixelForValue(t.x),o.getPixelForValue(t.y)),e.lineTo(a.getPixelForValue(c),o.getPixelForValue(s)),e.stroke()}}),e.restore()}}]})}function updateUIState(){document.getElementById("btn-ols").className="px-5 py-2 border-2 border-blue-600 rounded-lg font-semibold transition "+(config.showOls?"btn-active-ols":"text-blue-600 hover:bg-blue-50"),document.getElementById("btn-pca").className="px-5 py-2 border-2 border-emerald-600 rounded-lg font-semibold transition "+(config.showPca?"btn-active-pca":"text-emerald-600 hover:bg-emerald-50"),chart.setDatasetVisibility(1,config.showOls),chart.setDatasetVisibility(2,config.showPca),chart.update("none")}document.getElementById("btn-ols").onclick=()=>{config.showOls=!config.showOls,updateUIState()},document.getElementById("btn-pca").onclick=()=>{config.showPca=!config.showPca,updateUIState()},document.getElementById("btn-both").onclick=()=>{config.showOls=!0,config.showPca=!0,updateUIState()},document.getElementById("btn-hide").onclick=()=>{config.showOls=!1,config.showPca=!1,updateUIState()},document.getElementById("btn-reset").onclick=()=>{rawData=generateData(),currentStats=calculateStats(rawData);const t=rawData.map(t=>t.x),e=Math.min(...t),a=Math.max(...t);chart.data.datasets[0].data=rawData,chart.data.datasets[1].data=[{x:e,y:currentStats.olsSlope*e+currentStats.olsIntercept},{x:a,y:currentStats.olsSlope*a+currentStats.olsIntercept}],chart.data.datasets[2].data=[{x:e,y:currentStats.pcaSlope*e+currentStats.pcaIntercept},{x:a,y:currentStats.pcaSlope*a+currentStats.pcaIntercept}],chart.update()},window.onload=initChart</script>