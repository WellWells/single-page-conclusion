<!doctypehtml><html lang="zh-Hant"><meta name="twitter:image"content="https://wellstsai.com/single-page-conclusion/%E7%B6%93%E9%A9%97%E6%A8%A1%E6%85%8B%E5%88%86%E8%A7%A3-%E5%B8%8C%E7%88%BE%E4%BC%AF%E7%89%B9%E9%A0%BB%E8%AD%9C-%E5%8E%9F%E7%90%86%E8%88%87%E6%87%89%E7%94%A8.png"><meta name="twitter:description"content="介紹經驗模態分解(EMD)與希爾伯特頻譜，一種處理非線性、非平穩訊號的自適應方法。文章說明其篩選過程如何分解出固有模態函數(IMF)，以獲得高解析度時頻分佈，並比較與傅立葉、小波分析的差異。"><meta name="twitter:title"content="經驗模態分解-希爾伯特頻譜-原理與應用"><meta name="twitter:card"content="summary_large_image"><meta property="og:type"content="article"><meta property="og:site_name"content="WellWells"><meta property="og:image"content="https://wellstsai.com/single-page-conclusion/%E7%B6%93%E9%A9%97%E6%A8%A1%E6%85%8B%E5%88%86%E8%A7%A3-%E5%B8%8C%E7%88%BE%E4%BC%AF%E7%89%B9%E9%A0%BB%E8%AD%9C-%E5%8E%9F%E7%90%86%E8%88%87%E6%87%89%E7%94%A8.png"><meta property="og:url"content="https://wellstsai.com/single-page-conclusion/%E7%B6%93%E9%A9%97%E6%A8%A1%E6%85%8B%E5%88%86%E8%A7%A3-%E5%B8%8C%E7%88%BE%E4%BC%AF%E7%89%B9%E9%A0%BB%E8%AD%9C-%E5%8E%9F%E7%90%86%E8%88%87%E6%87%89%E7%94%A8.html"><meta property="og:description"content="介紹經驗模態分解(EMD)與希爾伯特頻譜，一種處理非線性、非平穩訊號的自適應方法。文章說明其篩選過程如何分解出固有模態函數(IMF)，以獲得高解析度時頻分佈，並比較與傅立葉、小波分析的差異。"><meta property="og:title"content="經驗模態分解-希爾伯特頻譜-原理與應用"><meta name="description"content="介紹經驗模態分解(EMD)與希爾伯特頻譜，一種處理非線性、非平穩訊號的自適應方法。文章說明其篩選過程如何分解出固有模態函數(IMF)，以獲得高解析度時頻分佈，並比較與傅立葉、小波分析的差異。"><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1"><title>非線性與非平穩時間序列分析</title><script src="https://cdn.tailwindcss.com"></script><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><link rel="preconnect"href="https://fonts.googleapis.com"><link rel="preconnect"href="https://fonts.gstatic.com"crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap"rel="stylesheet"><style>body{font-family:'Noto Sans TC',sans-serif;background-color:#f5f5f4;color:#334155}.chart-container{position:relative;width:100%;max-width:800px;margin-left:auto;margin-right:auto;height:40vh;max-height:400px}.h-64{height:16rem}.max-h-64{max-height:16rem}h1,h2,h3{color:#475569}.step-icon{background-color:#64748b;color:#fff;width:2.5rem;height:2.5rem;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-weight:700;font-size:1.25rem}.control-button{background-color:#475569;color:#fff;padding:.5rem 1.5rem;border-radius:.5rem;transition:background-color: .3s}.control-button:hover{background-color:#334155}.control-button:disabled{background-color:#94a3b8;cursor:not-allowed}.gradient-text{background-image:linear-gradient(to right,#475569,#38bdf8);-webkit-background-clip:text;background-clip:text;color:transparent}.keyword{color:#0369a1;background-color:rgba(56,189,248,.1);font-weight:700;cursor:pointer;position:relative;white-space:nowrap;transition:transform .2s,color .2s,background-color .2s;padding:2px 6px;border-radius:6px}.keyword:hover{transform:scale(1.05);color:#fff;background-color:#0369a1}.glass-border{border:1px solid transparent;background-clip:padding-box,border-box;background-origin:padding-box,border-box;background-image:linear-gradient(to right,#fafaf9,#fafaf9),linear-gradient(135deg,rgba(255,255,255,.6),rgba(255,255,255,.1))}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-JKC4KZLT26"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JKC4KZLT26")</script><body class="antialiased"><div class="container mx-auto px-4 py-8 md:py-12 max-w-5xl"><header class="text-center mb-12"><h1 class="text-3xl md:text-4xl font-bold mb-2">經驗模態分解與希爾伯特頻譜</h1><p class="text-lg text-slate-500">一個針對非線性、非平穩訊號的分析方法</header><main class="space-y-16"><section id="problem"><h2 class="text-2xl font-bold text-center mb-8">傳統分析方法的困境</h2><div class="bg-white rounded-lg shadow-md p-6 md:p-8"><p class="mb-4">在訊號處理中，我們經常遇到隨時間變化的訊號，例如地震波、金融數據或腦電圖。傳統的<span class="keyword"data-keyword="fourier">傅立葉分析 (Fourier Analysis)</span> 假設訊號是<span class="keyword"data-keyword="stationary">平穩</span>且線性的，這在現實世界中很少成立。當應用於<span class="keyword"data-keyword="nonstationary">非平穩</span>數據時，會產生兩個主要問題：<div class="grid md:grid-cols-2 gap-6 mt-6"><div class="bg-stone-50 p-4 rounded-lg"><h3 class="font-bold text-lg mb-2">能量擴散</h3><p>為了表示訊號的局部變化，傅立葉分析會使用大量諧波，導致能量在頻譜上散開，無法精確反映特定時間點的真實能量分佈。</div><div class="bg-stone-50 p-4 rounded-lg"><h3 class="font-bold text-lg mb-2">虛假諧波</h3><p>非線性或非平穩的波形會被誤解為多個諧波的疊加，這些「虛假」的諧波並沒有實際的物理意義，只是數學上的近似。</div></div></div></section><section id="solution"><h2 class="text-2xl font-bold text-center mb-8">新的解決方案：EMD + 希爾伯特頻譜</h2><div class="bg-white rounded-lg shadow-md p-6 md:p-8 text-center"><p class="mb-6">為了解決上述問題，黃鍔博士等人提出了一種創新的兩步驟方法：<div class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-8"><div class="text-center"><div class="step-icon mb-2">1</div><h3 class="font-bold text-lg"><span class="keyword"data-keyword="emd">經驗模態分解 (Empirical Mode Decomposition, EMD)</span></h3><p class="max-w-xs mx-auto">將複雜訊號分解成一系列簡單的「<span class="keyword"data-keyword="imf">固有模態函數</span>」(Intrinsic Mode Function, IMF)。</div><div class="text-slate-400 text-2xl hidden md:block">&rarr;</div><div class="text-slate-400 text-2xl md:hidden">&darr;</div><div class="text-center"><div class="step-icon mb-2">2</div><h3 class="font-bold text-lg">希爾伯特頻譜分析</h3><p class="max-w-xs mx-auto">對每個 IMF 進行分析，得到<span class="keyword"data-keyword="instantaneous_frequency">瞬時頻率</span>與能量，繪製成<span class="keyword"data-keyword="hilbert_spectrum">希爾伯特頻譜</span>。</div></div></div></section><section id="imf"><h2 class="text-2xl font-bold text-center mb-8">什麼是「<span class="keyword"data-keyword="imf">固有模態函數</span>」(Intrinsic Mode Function, IMF)？</h2><div class="bg-white rounded-lg shadow-md p-6 md:p-8"><p class="mb-4">固有模態函數 (IMF) 是一個特殊的函數，它代表了訊號中單一的、內在的振盪模式。一個函數要成為 IMF，必須滿足兩個條件：<ul class="list-disc list-inside space-y-2 mb-4"><li>在整個數據中，局部極值的數量和零交越點的數量必須相等或最多相差一。<li>在任何時間點，由局部極大值構成的上包絡線和局部極小值構成的下包絡線，其平均值必須為零。</ul><p>簡單來說，IMF 的波形必須是局部對稱的，不能有多個振盪模式疊加在一起（騎乘波, riding waves）。只有滿足這些條件，我們才能有意義地定義其「<span class="keyword"data-keyword="instantaneous_frequency">瞬時頻率</span>」。<p class="mt-6">下面是兩個範例圖，說明了什麼樣的波形可以作為 IMF，什麼樣的不行：<div class="grid md:grid-cols-2 gap-8 mt-6"><div><h3 class="text-lg font-semibold text-center mb-2">✅ 合格的 IMF 波形</h3><div class="chart-container h-64 max-h-64"><canvas id="imfValidChart"></canvas></div><p class="text-sm text-slate-500 mt-2 text-center">波形局部對稱，代表單一振盪模式。<br>（示意圖，實務上須經停止準則驗證）</div><div><h3 class="text-lg font-semibold text-center mb-2">❌ 不合格的波形 (多模式疊加)</h3><div class="chart-container h-64 max-h-64"><canvas id="imfInvalidChart"></canvas></div><p class="text-sm text-slate-500 mt-2 text-center">高頻波疊加在低頻波上，不代表單一模式。</div></div></div></section><section id="sifting"><h2 class="text-2xl font-bold text-center mb-8">圖解說明：<span class="keyword"data-keyword="sifting">篩選過程 (Sifting Process)</span></h2><div class="bg-white rounded-lg shadow-md p-6 md:p-8"><p class="text-center mb-4"><span class="keyword"data-keyword="emd">經驗模態分解 (EMD)</span> 的核心是「<span class="keyword"data-keyword="sifting">篩選過程</span>」，它像篩子一樣，逐步從訊號中分離出不同尺度的 <span class="keyword"data-keyword="imf">IMF</span>。請點擊下方的按鈕，一步步了解這個過程。<div class="chart-container"><canvas id="siftingChart"></canvas></div><div id="sifting-explanation"class="mt-4 text-center text-slate-600 min-h-[3em] p-2 bg-stone-50 rounded-md">這是我們的合成訊號：一個高頻波「騎」在一個低頻波上。</div><div class="flex justify-center mt-4 space-x-4"><button id="prevBtn"class="control-button"disabled="disabled">上一步</button> <button id="nextBtn"class="control-button">下一步</button></div></div></section><section id="hilbert-spectrum"><h2 class="text-2xl font-bold text-center mb-8">最終成果：<span class="keyword"data-keyword="hilbert_spectrum">希爾伯特頻譜</span></h2><div class="bg-white rounded-lg shadow-md p-6 md:p-8"><p class="mb-4">當我們將所有 <span class="keyword"data-keyword="imf">IMF</span> 分解出來後，就可以對每一個 <span class="keyword"data-keyword="imf">IMF</span> 進行希爾伯特轉換，計算出它在每一個時間點的<span class="keyword"data-keyword="instantaneous_frequency">瞬時頻率</span>和能量。將所有 <span class="keyword"data-keyword="imf">IMF</span> 的結果結合起來，就形成了<span class="keyword"data-keyword="hilbert_spectrum">希爾伯特頻譜</span>。<p class="mb-4"><span class="keyword"data-keyword="hilbert_spectrum">希爾伯特頻譜</span>是一個時間-頻率-能量的三維分佈圖。它能精確地告訴我們：<ul class="list-disc list-inside space-y-2"><li>在<strong>什麼時間</strong>...<li>出現了<strong>什麼頻率</strong>的振盪...<li>以及這個振盪帶有多少<strong>能量</strong>。</ul><p class="mt-4">這種表示方法提供了前所未有的高解析度，能清晰地揭示訊號隨時間變化的動態特徵，同時避免了傳統方法的能量擴散和虛假諧波問題。</div></section><section id="comparison"><h2 class="text-2xl font-bold text-center mb-8">主要訊號分析方法比較</h2><div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="bg-white rounded-lg shadow-md p-6 flex flex-col h-full"><div class="flex items-center mb-4 pb-4 border-b border-stone-200"><span class="text-3xl mr-4 text-sky-500">📈</span><h3 class="text-xl font-bold"><span class="keyword"data-keyword="fft">快速傅立葉轉換 (FFT)</span></h3></div><div class="space-y-4 text-sm flex-grow"><p><strong class="text-slate-500">理論依據：</strong> 正弦/複數指數基底<p><strong class="text-slate-500">適用信號：</strong> <span class="keyword"data-keyword="stationary">平穩</span>或週期性信號<div><strong class="text-slate-500">優點：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>頻率解析度高<li>演算法高效，運算快速</ul></div><div><strong class="text-slate-500">缺點：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>對<span class="keyword"data-keyword="nonstationary">非平穩</span>信號缺乏時間定位<li>有限長度與非整週期造成頻譜洩漏</ul></div><div><strong class="text-slate-500">限制與緩解：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>需長數據以獲得高頻率解析度<li>可透過適當窗函數緩解頻譜洩漏</ul></div><p><strong class="text-slate-500">常見應用：</strong> 頻譜分析、濾波、通訊、聲音/影像處理</div></div><div class="bg-white rounded-lg shadow-md p-6 flex flex-col h-full"><div class="flex items-center mb-4 pb-4 border-b border-stone-200"><span class="text-3xl mr-4 text-teal-500">🌊</span><h3 class="text-xl font-bold"><span class="keyword"data-keyword="wavelet">小波轉換</span></h3></div><div class="space-y-4 text-sm flex-grow"><p><strong class="text-slate-500">理論依據：</strong> 可縮放、平移的小波函數<p><strong class="text-slate-500">適用信號：</strong> <span class="keyword"data-keyword="nonstationary">非平穩</span>、含局部特徵的信號<div><strong class="text-slate-500">優點：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>同時提供時間與頻率(尺度)資訊<li>多解析度分析，對瞬變特徵敏感</ul></div><div><strong class="text-slate-500">缺點：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>需手動選擇母小波與分解層數<li>結果受母小波選擇影響</ul></div><div><strong class="text-slate-500">限制與緩解：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>根據信號特性選擇合適母小波<li>使用冗餘小波轉換緩解<span class="keyword"data-keyword="end_effects">邊界效應</span></ul></div><p><strong class="text-slate-500">常見應用：</strong> 地震分析、醫學信號(ECG/EEG)、影像壓縮 (JPEG2000)</div></div><div class="bg-white rounded-lg shadow-md p-6 flex flex-col h-full"><div class="flex items-center mb-4 pb-4 border-b border-stone-200"><span class="text-3xl mr-4 text-amber-500">🧩</span><h3 class="text-xl font-bold"><span class="keyword"data-keyword="emd">經驗模態分解 (EMD)</span></h3></div><div class="space-y-4 text-sm flex-grow"><p><strong class="text-slate-500">理論依據：</strong> 資料驅動的 Sifting 分解<p><strong class="text-slate-500">適用信號：</strong> 非線性且<span class="keyword"data-keyword="nonstationary">非平穩</span>信號<div><strong class="text-slate-500">優點：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>無需預設基底，完全自適應<li>可得到<span class="keyword"data-keyword="instantaneous_frequency">瞬時頻率</span>與局部分量</ul></div><div><strong class="text-slate-500">缺點：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>易受噪聲與<span class="keyword"data-keyword="end_effects">端點效應</span>影響<li><span class="keyword"data-keyword="mode_mixing">模態混疊</span>問題<li>數學基礎較薄弱</ul></div><div><strong class="text-slate-500">限制與緩解：</strong><ul class="list-disc list-inside ml-1 text-slate-600"><li>採用 EEMD/CEEMDAN 緩解<span class="keyword"data-keyword="mode_mixing">模態混疊</span><li>對資料先行去噪以提升穩定性</ul></div><p><strong class="text-slate-500">常見應用：</strong> 氣候資料、金融時序、機械振動、生物醫學信號 (搭配HHT)</div></div></div></section><section id="applications"><h2 class="text-2xl font-bold text-center mb-8">EMD 的實際應用</h2><div class="bg-white rounded-lg shadow-md p-6 md:p-8 space-y-8"><div><h3 class="text-xl font-bold mb-3">為何 EMD 被廣泛應用？</h3><p class="mb-4 text-slate-600"><span class="keyword"data-keyword="emd">經驗模態分解 (EMD)</span> 之所以廣泛用於處理非線性、<span class="keyword"data-keyword="nonstationary">非平穩</span>訊號，是因為它是<strong>資料驅動</strong>且對這類訊號特別友善。它能將複雜訊號自適應地分解為一系列物理意義更清晰的<span class="keyword"data-keyword="imf">內在模態函數 (IMFs)</span>，利於在多時間尺度上進行分析與特徵萃取。<p class="text-slate-600">與傳統的<span class="keyword"data-keyword="fourier">傅立葉</span>或<span class="keyword"data-keyword="wavelet">小波</span>分析不同，<span class="keyword"data-keyword="emd">EMD</span> 不需預設基底函數，能更直接地對應真實物理過程。然而，實務上需注意其<span class="keyword"data-keyword="end_effects">端點效應</span>與<span class="keyword"data-keyword="mode_mixing">模態混疊</span>等限制，常透過噪聲輔助的 EEMD/CEEMDAN 等方法來改善穩定性。</div><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-stone-50 p-5 rounded-lg"><div class="flex items-center mb-3"><span class="text-3xl mr-3">⚙️</span><h4 class="text-lg font-semibold">機械與工業監測</h4></div><ul class="list-disc list-inside text-sm space-y-1 text-slate-600"><li><strong>旋轉機械與軸承故障診斷：</strong>分離多頻成份，輔助早期異常檢測。<li><strong>材料檢測與生產線監視：</strong>分離<span class="keyword"data-keyword="nonstationary">非平穩</span>振動訊號的趨勢與雜訊。</ul></div><div class="bg-stone-50 p-5 rounded-lg"><div class="flex items-center mb-3"><span class="text-3xl mr-3">❤️</span><h4 class="text-lg font-semibold">醫療與生物訊號</h4></div><ul class="list-disc list-inside text-sm space-y-1 text-slate-600"><li><strong>ECG/EEG/EMG 分析：</strong>去趨勢、去雜訊，提高病理事件辨識率。<li><strong>生物節律解讀：</strong>改善<span class="keyword"data-keyword="nonstationary">非平穩</span>生理資料的時頻表徵與解釋性。</ul></div><div class="bg-stone-50 p-5 rounded-lg"><div class="flex items-center mb-3"><span class="text-3xl mr-3">⚡️</span><h4 class="text-lg font-semibold">能源與電力系統</h4></div><ul class="list-disc list-inside text-sm space-y-1 text-slate-600"><li><strong>電力負載與再生能源預測：</strong>分解後對子序列建模，提升準確度。<li><strong>電能品質分析：</strong>處理瞬變、閃變等<span class="keyword"data-keyword="nonstationary">非平穩</span>擾動。</ul></div><div class="bg-stone-50 p-5 rounded-lg"><div class="flex items-center mb-3"><span class="text-3xl mr-3">💰</span><h4 class="text-lg font-semibold">金融與經濟</h4></div><ul class="list-disc list-inside text-sm space-y-1 text-slate-600"><li><strong>多尺度趨勢/週期分離：</strong>有助於短中長期策略分層建模。<li><strong>結構性變化偵測：</strong>透過 <span class="keyword"data-keyword="imf">IMFs</span> 減輕非線性疊加的干擾。</ul></div><div class="bg-stone-50 p-5 rounded-lg"><div class="flex items-center mb-3"><span class="text-3xl mr-3">🌍</span><h4 class="text-lg font-semibold">地球科學與氣候</h4></div><ul class="list-disc list-inside text-sm space-y-1 text-slate-600"><li><strong>地震活動與震波分析：</strong>分離趨勢與不同頻段能量。<li><strong>氣候指標多尺度分解：</strong>理解變率來源與局部週期性。</ul></div><div class="bg-stone-50 p-5 rounded-lg"><div class="flex items-center mb-3"><span class="text-3xl mr-3">🖼️</span><h4 class="text-lg font-semibold">語音、聲學與影像</h4></div><ul class="list-disc list-inside text-sm space-y-1 text-slate-600"><li><strong>語音去噪與特徵擷取：</strong>將語音訊號的多尺度振盪分離。<li><strong>影像處理：</strong>支援影像紋理、邊緣強化與瑕疵檢測。</ul></div><div class="bg-stone-50 p-5 rounded-lg"><div class="flex items-center mb-3"><span class="text-3xl mr-3">🌉</span><h4 class="text-lg font-semibold">結構健康監測</h4></div><ul class="list-disc list-inside text-sm space-y-1 text-slate-600"><li><strong>橋梁/建物振動資料分析：</strong>處理載重與環境引起的<span class="keyword"data-keyword="nonstationary">非平穩</span>效應。<li><strong>長期監測資料去趨勢：</strong>利於基線建立與異常偵測。</ul></div><div class="bg-stone-50 p-5 rounded-lg"><div class="flex items-center mb-3"><span class="text-3xl mr-3">🌊</span><h4 class="text-lg font-semibold">水文與海洋科學</h4></div><ul class="list-disc list-inside text-sm space-y-1 text-slate-600"><li><strong>風浪、潮汐與海洋動力分析：</strong>萃取高頻與低頻成份。<li><strong>水文時間序列預測：</strong>改善模型對<span class="keyword"data-keyword="nonstationary">非平穩</span>變化的適應性。</ul></div></div></div></section><section id="conclusion"><h2 class="text-2xl font-bold text-center mb-8">結論</h2><div class="bg-white rounded-lg shadow-md p-6 md:p-8"><p class="mb-4">經驗模態分解與希爾伯特頻譜分析為處理現實世界中常見的非線性、<span class="keyword"data-keyword="nonstationary">非平穩</span>數據提供了一個強大且物理意義清晰的工具。它的核心創新在於：<div class="grid md:grid-cols-3 gap-6 mt-6"><div class="bg-stone-50 p-4 rounded-lg"><h3 class="font-bold text-lg mb-2">自適應基底</h3><p>分解出的 <span class="keyword"data-keyword="imf">IMF</span> 完全由數據本身決定，不需預設任何基底函數。</div><div class="bg-stone-50 p-4 rounded-lg"><h3 class="font-bold text-lg mb-2">物理意義</h3><p><span class="keyword"data-keyword="instantaneous_frequency">瞬時頻率</span>能揭示波形內部的頻率變化，這直接反映了系統的非線性特性。</div><div class="bg-stone-50 p-4 rounded-lg"><h3 class="font-bold text-lg mb-2">高解析度</h3><p>在若干非平穩訊號上可呈現更清晰的時間-頻率-能量分佈，但成效仰賴分解品質與資料條件。</div></div></div></section></main><footer class="text-center mt-16 py-8 bg-stone-200 text-slate-600"><a href="https://wellstsai.com"target="_blank"rel="noopener noreferrer"class="text-slate-700 hover:text-sky-600 transition-colors">Generated by wellstsai.com</a><p class="text-sm mt-2">撰寫日期：2025年9月20日</footer></div><div id="keyword-modal"class="fixed inset-0 z-50 flex items-center justify-center p-4 hidden"aria-hidden="true"role="dialog"aria-modal="true"><div id="modal-backdrop"class="fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300 ease-in-out opacity-0"></div><div id="modal-panel"class="relative bg-stone-100/80 backdrop-blur-xl rounded-2xl shadow-2xl w-full max-w-2xl text-slate-800 glass-border transition-all duration-300 ease-in-out opacity-0 scale-95"><div class="p-6 md:p-8"><div class="flex justify-between items-center pb-4 border-b border-gray-500/20"><h3 id="modal-title"class="text-2xl font-bold gradient-text"></h3><button id="modal-close-button"aria-label="關閉"class="text-gray-500 hover:text-gray-900 transition-colors"><svg class="w-6 h-6"fill="none"stroke="currentColor"viewBox="0 0 24 24"><path stroke-linecap="round"stroke-linejoin="round"stroke-width="2"d="M6 18L18 6M6 6l12 12"/></svg></button></div><div id="modal-content"class="mt-4 text-slate-600 leading-relaxed space-y-4"></div></div></div></div><script>const getSpline=(t,e)=>{const a=t.length-1;if(a<1)return t=>e.length>0?e[0]:0;const n=e.slice(),i=Array(a).fill(0),o=Array(a).fill(0),r=t.slice(1).map((e,a)=>e-t[a]),d=Array(a).fill(0);for(let t=1;t<a;t++)0!==r[t]&&0!==r[t-1]&&(d[t]=3/r[t]*(n[t+1]-n[t])-3/r[t-1]*(n[t]-n[t-1]));const l=Array(a+1).fill(0),s=Array(a+1).fill(0),c=Array(a+1).fill(0),p=Array(a+1).fill(0);s[0]=1;for(let e=1;e<a;e++)s[e]=2*(t[e+1]-t[e-1])-r[e-1]*c[e-1],c[e]=r[e]/s[e],p[e]=(d[e]-r[e-1]*p[e-1])/s[e];s[a]=1;for(let t=a-1;t>=0;t--)l[t]=p[t]-c[t]*l[t+1],0===r[t]?(i[t]=0,o[t]=0):(i[t]=(n[t+1]-n[t])/r[t]-r[t]*(l[t+1]+2*l[t])/3,o[t]=(l[t+1]-l[t])/(3*r[t]));return e=>{let r=t.findIndex(t=>t>e)-1;r<0&&(r=0),r>=a&&(r=a-1);const d=e-t[r];return n[r]+i[r]*d+l[r]*d**2+o[r]*d**3}},getExtrema=t=>{const e={x:[],y:[]},a={x:[],y:[]};for(let n=1;n<t.length-1;n++)t[n]>t[n-1]&&t[n]>t[n+1]&&(e.x.push(n),e.y.push(t[n])),t[n]<t[n-1]&&t[n]<t[n+1]&&(a.x.push(n),a.y.push(t[n]));return{maxima:e,minima:a}},siftOnce=(t,e)=>{const{maxima:a,minima:n}=getExtrema(t);if(a.x.length<2||n.x.length<2)return{h:t,mean:Array(t.length).fill(0),upper:t,lower:t,maxima:a,minima:n};const i=getSpline([0,...a.x,e.length-1],[t[0],...a.y,t[e.length-1]]),o=getSpline([0,...n.x,e.length-1],[t[0],...n.y,t[e.length-1]]),r=e.map(t=>i(t)),d=e.map(t=>o(t)),l=e.map((t,e)=>(r[e]+d[e])/2);return{h:e.map((e,a)=>t[a]-l[a]),mean:l,upper:r,lower:d,maxima:a,minima:n}},labels=Array.from({length:200},(t,e)=>e),highFreq=labels.map(t=>Math.sin(.8*t)),lowFreq=labels.map(t=>2*Math.cos(.1*t)),originalSignal=labels.map((t,e)=>highFreq[e]+lowFreq[e]),s1=siftOnce(originalSignal,labels),c1=s1.h,r1=labels.map((t,e)=>originalSignal[e]-c1[e]),ctx=document.getElementById("siftingChart").getContext("2d"),siftingChart=new Chart(ctx,{type:"line",data:{labels:labels,datasets:[{label:"原始訊號",data:originalSignal,borderColor:"#64748B",borderWidth:2.5,pointRadius:0,tension:.1},{label:"高頻 IMF (c1)",data:c1,borderColor:"#F97316",borderWidth:2,pointRadius:0,tension:.1,hidden:!0},{label:"殘差 (r1)",data:r1,borderColor:"#84CC16",borderWidth:2,pointRadius:0,tension:.1,hidden:!0},{label:"上包絡線",data:s1.upper,borderColor:"#F87171",borderWidth:1.5,borderDash:[5,5],pointRadius:0,hidden:!0},{label:"下包絡線",data:s1.lower,borderColor:"#60A5FA",borderWidth:1.5,borderDash:[5,5],pointRadius:0,hidden:!0},{label:"平均線",data:s1.mean,borderColor:"#10B981",borderWidth:2,pointRadius:0,hidden:!0},{label:"極大值",data:s1.maxima.y.map((t,e)=>({x:s1.maxima.x[e],y:t})),type:"scatter",backgroundColor:"#EF4444",hidden:!0},{label:"極小值",data:s1.minima.y.map((t,e)=>({x:s1.minima.x[e],y:t})),type:"scatter",backgroundColor:"#3B82F6",hidden:!0},{label:"原始訊號 (對照)",data:originalSignal,borderColor:"#94A3B8",borderWidth:2,borderDash:[5,5],pointRadius:0,hidden:!0,tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{display:!1},y:{min:-4.5,max:4.5}},plugins:{legend:{display:!1}},animation:{duration:500}}}),prevBtn=document.getElementById("prevBtn"),nextBtn=document.getElementById("nextBtn"),explanation=document.getElementById("sifting-explanation");let currentStep=0;const steps=[{explanation:"這是我們的合成訊號：一個高頻波「騎」在一個低頻波上。我們的目標是分離出高頻成分。",actions:()=>{siftingChart.data.datasets.forEach((t,e)=>t.hidden=0!==e)}},{explanation:"步驟 1/4: 找出原始訊號的局部極大/極小值(紅/藍點)，並繪製上下包絡線。",actions:()=>{siftingChart.data.datasets.forEach((t,e)=>t.hidden=![0,3,4,6,7].includes(e))}},{explanation:"步驟 2/4: 計算上下包絡線的平均值（綠色線）。",actions:()=>{siftingChart.data.datasets.forEach((t,e)=>t.hidden=![0,3,4,5,6,7].includes(e))}},{explanation:"步驟 3/4: 從原始訊號減去平均線，得到一個候選分量 (h)。此過程需重複迭代，直到 h 滿足 IMF 條件。",actions:()=>{siftingChart.data.datasets.forEach((t,e)=>t.hidden=1!==e)}},{explanation:"步驟 4/4: 為簡化說明，假設 h 已滿足條件，將其視為第一個 IMF (c1)。從原始訊號減去 c1，得到殘差 (r1)。",actions:()=>{siftingChart.data.datasets.forEach((t,e)=>t.hidden=2!==e)}},{explanation:"分解完成！我們已分離出最高頻的 IMF (橘線)與殘差 (綠線)，並與原始訊號(虛線)對照。",actions:()=>{siftingChart.data.datasets.forEach((t,e)=>t.hidden=![1,2,8].includes(e))}},{explanation:"理論上，我們會對綠色的殘差訊號重複整個篩選過程，以分離出下一個（較低頻的）IMF。",actions:()=>{siftingChart.data.datasets.forEach((t,e)=>t.hidden=![1,2,8].includes(e))}}],maxSteps=steps.length-1;function updateState(){explanation.textContent=steps[currentStep].explanation,steps[currentStep].actions(),siftingChart.update(),prevBtn.disabled=0===currentStep,nextBtn.disabled=currentStep===maxSteps}nextBtn.addEventListener("click",()=>{currentStep<maxSteps&&(currentStep++,updateState())}),prevBtn.addEventListener("click",()=>{currentStep>0&&(currentStep--,updateState())}),updateState();const commonChartOptions={responsive:!0,maintainAspectRatio:!1,scales:{x:{display:!1},y:{ticks:{display:!1}}},plugins:{legend:{display:!1}}},imfLabels=Array.from({length:100},(t,e)=>e),validCtx=document.getElementById("imfValidChart").getContext("2d"),validImfData=imfLabels.map(t=>Math.cos(.3*t)*(1+.1*Math.sin(.1*t)));new Chart(validCtx,{type:"line",data:{labels:imfLabels,datasets:[{data:validImfData,borderColor:"#3B82F6",borderWidth:2,pointRadius:0,tension:.3}]},options:commonChartOptions});const invalidCtx=document.getElementById("imfInvalidChart").getContext("2d"),invalidImfData=labels.map((t,e)=>highFreq[e]+lowFreq[e]);new Chart(invalidCtx,{type:"line",data:{labels:labels,datasets:[{data:invalidImfData,borderColor:"#EF4444",borderWidth:2,pointRadius:0,tension:.1}]},options:commonChartOptions}),(()=>{const t={fourier:{title:"傅立葉分析 (Fourier Analysis)",content:"<p>一種傳統的訊號處理方法，將訊號分解為一系列不同頻率的正弦波。它假設訊號是平穩且線性的，對於隨時間變化的非平穩訊號，容易產生能量擴散與虛假諧波等問題。</p>"},stationary:{title:"平穩訊號 (Stationary Signal)",content:"<p>指其統計特性（如均值、方差）不會隨時間改變的訊號。傅立葉分析等傳統方法建立在此假設之上。</p>"},nonstationary:{title:"非平穩訊號 (Non-stationary Signal)",content:"<p>指其統計特性（如均值、方差）會隨時間改變的訊號。現實世界中的許多訊號，如地震波、氣候數據和金融時序，都屬於此類。傳統的傅立葉分析不擅長處理這類訊號。</p>"},emd:{title:"經驗模態分解 (EMD)",content:"<p>一種自適應的訊號處理方法，能將複雜的非線性、非平穩訊號分解為一系列稱為「固有模態函數」(IMF) 的簡單振盪分量。其核心是「篩選過程」，且無需預設任何基底函數。</p>"},imf:{title:"固有模態函數 (IMF)",content:"<p>代表訊號中單一內在振盪模式的函數。它必須滿足兩個條件：局部極值與零交越點數量相近，且上下包絡線的局部平均值為零。IMF 的波形是局部對稱的，可用於計算有物理意義的瞬時頻率。</p>"},hilbert_spectrum:{title:"希爾伯特頻譜 (Hilbert Spectrum)",content:"<p>對 EMD 分解出的每個 IMF 進行希爾伯特轉換後，所得到的「時間-頻率-能量」分佈圖。它能高解析度地呈現能量在時間與頻率上的變化，避免了傳統方法的缺點。</p>"},instantaneous_frequency:{title:"瞬時頻率 (Instantaneous Frequency)",content:"<p>描述一個訊號在特定時間點的頻率。傳統方法難以定義，但在希爾伯特-黃轉換中，可以透過對 IMF 的相位進行微分來計算，從而揭示訊號內部的頻率調變，反映非線性與非平穩特性。</p>"},sifting:{title:"篩選過程 (Sifting Process)",content:"<p>EMD 的核心演算法。它透過一個迭代過程，找出訊號的上下包絡線，計算其平均值，然後從原訊號中減去此平均值，逐步「篩」出最高頻率的 IMF 分量。對剩餘的殘差重複此過程，即可得到所有 IMF。</p>"},mode_mixing:{title:"模態混疊 (Mode-mixing)",content:"<p>EMD 的一個主要限制。指單一的 IMF 中包含了不同尺度的振盪，或者同一尺度的振盪被分散到不同的 IMF 中。這會影響分解結果的物理可解釋性。使用 EEMD 或 CEEMDAN 等方法可以有效緩解此問題。</p>"},end_effects:{title:"端點效應 (End Effects)",content:"<p>在 EMD 的篩選過程中，由於數據兩端的資料不足，樣條插值在計算包絡線時容易產生較大的誤差，並可能向內傳播，影響分解的準確性。這是一個需要特別處理的實務問題。</p>"},wavelet:{title:"小波轉換 (Wavelet Transform)",content:"<p>一種時頻分析方法，使用可縮放、平移的「母小波」作為基底來分析訊號。它能同時提供時間與尺度的資訊，特別適合分析含有局部瞬變特徵的非平穩訊號。</p>"},fft:{title:"快速傅立葉轉換 (FFT)",content:"<p>一種高效計算離散傅立葉轉換 (DFT) 的演算法。它是頻譜分析中最常用的工具之一，但其基本假設與傅立葉分析相同，主要適用於平穩或週期性信號。</p>"}},e=document.getElementById("keyword-modal"),a=document.getElementById("modal-backdrop"),n=document.getElementById("modal-panel"),i=document.getElementById("modal-title"),o=document.getElementById("modal-content"),r=document.getElementById("modal-close-button"),d=()=>{document.body.style.overflow="",a.classList.add("opacity-0"),n.classList.add("opacity-0","scale-95"),e.setAttribute("aria-hidden","true");const t=()=>{e.classList.add("hidden"),n.removeEventListener("transitionend",t)};n.addEventListener("transitionend",t)};document.addEventListener("click",l=>{const s=l.target.closest(".keyword");if(s&&s.dataset.keyword)return(r=>{const d=t[r];d&&(i.textContent=d.title,o.innerHTML=d.content,document.body.style.overflow="hidden",e.classList.remove("hidden"),e.setAttribute("aria-hidden","false"),requestAnimationFrame(()=>{a.classList.remove("opacity-0"),n.classList.remove("opacity-0","scale-95")}))})(s.dataset.keyword);(l.target===a||r.contains(l.target))&&d()}),document.addEventListener("keydown",t=>{"Escape"===t.key&&"false"===e.getAttribute("aria-hidden")&&d()})})()</script>